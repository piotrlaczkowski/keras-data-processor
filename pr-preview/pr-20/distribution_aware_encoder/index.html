
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.1">
    
    
      
        <title>Distribution-Aware Encoder - KDP - Keras Data Preprocessor</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.a40c8224.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      
  
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
  
  <style>:root{--md-admonition-icon--note:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M1 7.775V2.75C1 1.784 1.784 1 2.75 1h5.025c.464 0 .91.184 1.238.513l6.25 6.25a1.75 1.75 0 0 1 0 2.474l-5.026 5.026a1.75 1.75 0 0 1-2.474 0l-6.25-6.25A1.75 1.75 0 0 1 1 7.775m1.5 0c0 .066.026.13.073.177l6.25 6.25a.25.25 0 0 0 .354 0l5.025-5.025a.25.25 0 0 0 0-.354l-6.25-6.25a.25.25 0 0 0-.177-.073H2.75a.25.25 0 0 0-.25.25ZM6 5a1 1 0 1 1 0 2 1 1 0 0 1 0-2"/></svg>');--md-admonition-icon--abstract:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M2.5 1.75v11.5c0 .138.112.25.25.25h3.17a.75.75 0 0 1 0 1.5H2.75A1.75 1.75 0 0 1 1 13.25V1.75C1 .784 1.784 0 2.75 0h8.5C12.216 0 13 .784 13 1.75v7.736a.75.75 0 0 1-1.5 0V1.75a.25.25 0 0 0-.25-.25h-8.5a.25.25 0 0 0-.25.25m13.274 9.537zl-4.557 4.45a.75.75 0 0 1-1.055-.008l-1.943-1.95a.75.75 0 0 1 1.062-1.058l1.419 1.425 4.026-3.932a.75.75 0 1 1 1.048 1.074M4.75 4h4.5a.75.75 0 0 1 0 1.5h-4.5a.75.75 0 0 1 0-1.5M4 7.75A.75.75 0 0 1 4.75 7h2a.75.75 0 0 1 0 1.5h-2A.75.75 0 0 1 4 7.75"/></svg>');--md-admonition-icon--info:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8m8-6.5a6.5 6.5 0 1 0 0 13 6.5 6.5 0 0 0 0-13M6.5 7.75A.75.75 0 0 1 7.25 7h1a.75.75 0 0 1 .75.75v2.75h.25a.75.75 0 0 1 0 1.5h-2a.75.75 0 0 1 0-1.5h.25v-2h-.25a.75.75 0 0 1-.75-.75M8 6a1 1 0 1 1 0-2 1 1 0 0 1 0 2"/></svg>');--md-admonition-icon--tip:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M3.499.75a.75.75 0 0 1 1.5 0v.996C5.9 2.903 6.793 3.65 7.662 4.376l.24.202c-.036-.694.055-1.422.426-2.163C9.1.873 10.794-.045 12.622.26 14.408.558 16 1.94 16 4.25c0 1.278-.954 2.575-2.44 2.734l.146.508.065.22c.203.701.412 1.455.476 2.226.142 1.707-.4 3.03-1.487 3.898C11.714 14.671 10.27 15 8.75 15h-6a.75.75 0 0 1 0-1.5h1.376a4.5 4.5 0 0 1-.563-1.191 3.84 3.84 0 0 1-.05-2.063 4.65 4.65 0 0 1-2.025-.293.75.75 0 0 1 .525-1.406c1.357.507 2.376-.006 2.698-.318l.009-.01a.747.747 0 0 1 1.06 0 .75.75 0 0 1-.012 1.074c-.912.92-.992 1.835-.768 2.586.221.74.745 1.337 1.196 1.621H8.75c1.343 0 2.398-.296 3.074-.836.635-.507 1.036-1.31.928-2.602-.05-.603-.216-1.224-.422-1.93l-.064-.221c-.12-.407-.246-.84-.353-1.29a2.4 2.4 0 0 1-.507-.441 3.1 3.1 0 0 1-.633-1.248.75.75 0 0 1 1.455-.364c.046.185.144.436.31.627.146.168.353.305.712.305.738 0 1.25-.615 1.25-1.25 0-1.47-.95-2.315-2.123-2.51-1.172-.196-2.227.387-2.706 1.345-.46.92-.27 1.774.019 3.062l.042.19.01.05c.348.443.666.949.94 1.553a.75.75 0 1 1-1.365.62c-.553-1.217-1.32-1.94-2.3-2.768L6.7 5.527c-.814-.68-1.75-1.462-2.692-2.619a3.7 3.7 0 0 0-1.023.88c-.406.495-.663 1.036-.722 1.508.116.122.306.21.591.239.388.038.797-.06 1.032-.19a.75.75 0 0 1 .728 1.31c-.515.287-1.23.439-1.906.373-.682-.067-1.473-.38-1.879-1.193L.75 5.677V5.5c0-.984.48-1.94 1.077-2.664.46-.559 1.05-1.055 1.673-1.353z"/></svg>');--md-admonition-icon--success:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.75.75 0 0 1 .018-1.042.75.75 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0"/></svg>');--md-admonition-icon--question:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8m8-6.5a6.5 6.5 0 1 0 0 13 6.5 6.5 0 0 0 0-13M6.92 6.085h.001a.749.749 0 1 1-1.342-.67c.169-.339.436-.701.849-.977C6.845 4.16 7.369 4 8 4a2.76 2.76 0 0 1 1.637.525c.503.377.863.965.863 1.725 0 .448-.115.83-.329 1.15-.205.307-.47.513-.692.662-.109.072-.22.138-.313.195l-.006.004a6 6 0 0 0-.26.16 1 1 0 0 0-.276.245.75.75 0 0 1-1.248-.832c.184-.264.42-.489.692-.661q.154-.1.313-.195l.007-.004c.1-.061.182-.11.258-.161a1 1 0 0 0 .277-.245C8.96 6.514 9 6.427 9 6.25a.61.61 0 0 0-.262-.525A1.27 1.27 0 0 0 8 5.5c-.369 0-.595.09-.74.187a1 1 0 0 0-.34.398M9 11a1 1 0 1 1-2 0 1 1 0 0 1 2 0"/></svg>');--md-admonition-icon--warning:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M6.457 1.047c.659-1.234 2.427-1.234 3.086 0l6.082 11.378A1.75 1.75 0 0 1 14.082 15H1.918a1.75 1.75 0 0 1-1.543-2.575Zm1.763.707a.25.25 0 0 0-.44 0L1.698 13.132a.25.25 0 0 0 .22.368h12.164a.25.25 0 0 0 .22-.368Zm.53 3.996v2.5a.75.75 0 0 1-1.5 0v-2.5a.75.75 0 0 1 1.5 0M9 11a1 1 0 1 1-2 0 1 1 0 0 1 2 0"/></svg>');--md-admonition-icon--failure:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M2.344 2.343za8 8 0 0 1 11.314 11.314A8.002 8.002 0 0 1 .234 10.089a8 8 0 0 1 2.11-7.746m1.06 10.253a6.5 6.5 0 1 0 9.108-9.275 6.5 6.5 0 0 0-9.108 9.275M6.03 4.97 8 6.94l1.97-1.97a.749.749 0 0 1 1.275.326.75.75 0 0 1-.215.734L9.06 8l1.97 1.97a.749.749 0 0 1-.326 1.275.75.75 0 0 1-.734-.215L8 9.06l-1.97 1.97a.749.749 0 0 1-1.275-.326.75.75 0 0 1 .215-.734L6.94 8 4.97 6.03a.75.75 0 0 1 .018-1.042.75.75 0 0 1 1.042-.018"/></svg>');--md-admonition-icon--danger:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M9.504.43a1.516 1.516 0 0 1 2.437 1.713L10.415 5.5h2.123c1.57 0 2.346 1.909 1.22 3.004l-7.34 7.142a1.25 1.25 0 0 1-.871.354h-.302a1.25 1.25 0 0 1-1.157-1.723L5.633 10.5H3.462c-1.57 0-2.346-1.909-1.22-3.004zm1.047 1.074L3.286 8.571A.25.25 0 0 0 3.462 9H6.75a.75.75 0 0 1 .694 1.034l-1.713 4.188 6.982-6.793A.25.25 0 0 0 12.538 7H9.25a.75.75 0 0 1-.683-1.06l2.008-4.418.003-.006-.004-.009-.006-.006-.008-.001q-.005 0-.009.004"/></svg>');--md-admonition-icon--bug:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M4.72.22a.75.75 0 0 1 1.06 0l1 .999a3.5 3.5 0 0 1 2.441 0l.999-1a.748.748 0 0 1 1.265.332.75.75 0 0 1-.205.729l-.775.776c.616.63.995 1.493.995 2.444v.327q0 .15-.025.292c.408.14.764.392 1.029.722l1.968-.787a.75.75 0 0 1 .556 1.392L13 7.258V9h2.25a.75.75 0 0 1 0 1.5H13v.5q-.002.615-.141 1.186l2.17.868a.75.75 0 0 1-.557 1.392l-2.184-.873A5 5 0 0 1 8 16a5 5 0 0 1-4.288-2.427l-2.183.873a.75.75 0 0 1-.558-1.392l2.17-.868A5 5 0 0 1 3 11v-.5H.75a.75.75 0 0 1 0-1.5H3V7.258L.971 6.446a.75.75 0 0 1 .558-1.392l1.967.787c.265-.33.62-.583 1.03-.722a1.7 1.7 0 0 1-.026-.292V4.5c0-.951.38-1.814.995-2.444L4.72 1.28a.75.75 0 0 1 0-1.06m.53 6.28a.75.75 0 0 0-.75.75V11a3.5 3.5 0 1 0 7 0V7.25a.75.75 0 0 0-.75-.75ZM6.173 5h3.654A.17.17 0 0 0 10 4.827V4.5a2 2 0 1 0-4 0v.327c0 .096.077.173.173.173"/></svg>');--md-admonition-icon--example:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M5 5.782V2.5h-.25a.75.75 0 0 1 0-1.5h6.5a.75.75 0 0 1 0 1.5H11v3.282l3.666 5.76C15.619 13.04 14.543 15 12.767 15H3.233c-1.776 0-2.852-1.96-1.899-3.458Zm-2.4 6.565a.75.75 0 0 0 .633 1.153h9.534a.75.75 0 0 0 .633-1.153L12.225 10.5h-8.45ZM9.5 2.5h-3V6c0 .143-.04.283-.117.403L4.73 9h6.54L9.617 6.403A.75.75 0 0 1 9.5 6Z"/></svg>');--md-admonition-icon--quote:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M1.75 2.5h10.5a.75.75 0 0 1 0 1.5H1.75a.75.75 0 0 1 0-1.5m4 5h8.5a.75.75 0 0 1 0 1.5h-8.5a.75.75 0 0 1 0-1.5m0 5h8.5a.75.75 0 0 1 0 1.5h-8.5a.75.75 0 0 1 0-1.5M2.5 7.75v6a.75.75 0 0 1-1.5 0v-6a.75.75 0 0 1 1.5 0"/></svg>');}</style>



    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent="black">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#distribution-aware-encoder" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="KDP - Keras Data Preprocessor" class="md-header__button md-logo" aria-label="KDP - Keras Data Preprocessor" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 11a1 1 0 0 1 1 1 1 1 0 0 1-1 1 1 1 0 0 1-1-1 1 1 0 0 1 1-1M4.22 4.22C5.65 2.79 8.75 3.43 12 5.56c3.25-2.13 6.35-2.77 7.78-1.34s.79 4.53-1.34 7.78c2.13 3.25 2.77 6.35 1.34 7.78s-4.53.79-7.78-1.34c-3.25 2.13-6.35 2.77-7.78 1.34S3.43 15.25 5.56 12C3.43 8.75 2.79 5.65 4.22 4.22m11.32 4.24c.61.62 1.17 1.25 1.69 1.88 1.38-2.13 1.88-3.96 1.13-4.7-.74-.75-2.57-.25-4.7 1.13.63.52 1.26 1.08 1.88 1.69m-7.08 7.08c-.61-.62-1.17-1.25-1.69-1.88-1.38 2.13-1.88 3.96-1.13 4.7.74.75 2.57.25 4.7-1.13-.63-.52-1.26-1.08-1.88-1.69m-2.82-9.9c-.75.74-.25 2.57 1.13 4.7.52-.63 1.08-1.26 1.69-1.88.62-.61 1.25-1.17 1.88-1.69-2.13-1.38-3.96-1.88-4.7-1.13m4.24 8.48c.7.7 1.42 1.34 2.12 1.91.7-.57 1.42-1.21 2.12-1.91s1.34-1.42 1.91-2.12c-.57-.7-1.21-1.42-1.91-2.12S12.7 8.54 12 7.97c-.7.57-1.42 1.21-2.12 1.91S8.54 11.3 7.97 12c.57.7 1.21 1.42 1.91 2.12m8.48 4.24c.75-.74.25-2.57-1.13-4.7-.52.63-1.08 1.26-1.69 1.88-.62.61-1.25 1.17-1.88 1.69 2.13 1.38 3.96 1.88 4.7 1.13"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            KDP - Keras Data Preprocessor
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Distribution-Aware Encoder
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent="black"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="teal" data-md-color-accent="teal"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/piotrlaczkowski/keras-data-processor" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    Keras Data Preprocessor
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="KDP - Keras Data Preprocessor" class="md-nav__button md-logo" aria-label="KDP - Keras Data Preprocessor" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 11a1 1 0 0 1 1 1 1 1 0 0 1-1 1 1 1 0 0 1-1-1 1 1 0 0 1 1-1M4.22 4.22C5.65 2.79 8.75 3.43 12 5.56c3.25-2.13 6.35-2.77 7.78-1.34s.79 4.53-1.34 7.78c2.13 3.25 2.77 6.35 1.34 7.78s-4.53.79-7.78-1.34c-3.25 2.13-6.35 2.77-7.78 1.34S3.43 15.25 5.56 12C3.43 8.75 2.79 5.65 4.22 4.22m11.32 4.24c.61.62 1.17 1.25 1.69 1.88 1.38-2.13 1.88-3.96 1.13-4.7-.74-.75-2.57-.25-4.7 1.13.63.52 1.26 1.08 1.88 1.69m-7.08 7.08c-.61-.62-1.17-1.25-1.69-1.88-1.38 2.13-1.88 3.96-1.13 4.7.74.75 2.57.25 4.7-1.13-.63-.52-1.26-1.08-1.88-1.69m-2.82-9.9c-.75.74-.25 2.57 1.13 4.7.52-.63 1.08-1.26 1.69-1.88.62-.61 1.25-1.17 1.88-1.69-2.13-1.38-3.96-1.88-4.7-1.13m4.24 8.48c.7.7 1.42 1.34 2.12 1.91.7-.57 1.42-1.21 2.12-1.91s1.34-1.42 1.91-2.12c-.57-.7-1.21-1.42-1.91-2.12S12.7 8.54 12 7.97c-.7.57-1.42 1.21-2.12 1.91S8.54 11.3 7.97 12c.57.7 1.21 1.42 1.91 2.12m8.48 4.24c.75-.74.25-2.57-1.13-4.7-.52.63-1.08 1.26-1.69 1.88-.62.61-1.25 1.17-1.88 1.69 2.13 1.38 3.96 1.88 4.7 1.13"/></svg>

    </a>
    KDP - Keras Data Preprocessor
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/piotrlaczkowski/keras-data-processor" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    Keras Data Preprocessor
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    🏠 Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../kdp_overview/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    💡 Understanding KDP
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../features/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    🛠️ Key Features
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    🏭 Factory System
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            🏭 Factory System
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../layers_factory/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    🏗️ Layers Factory
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../integrations/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    📦 Integrating Preprocessing Models
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    🔌 Model Extensions
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            🔌 Model Extensions
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../transformer_blocks/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    🤖 Transformer Blocks
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tabular_attention/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    🎯 Tabular Attention
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../feature_selection/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    🔂 Feature Selection
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    🏗️ Usage & Examples
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            🏗️ Usage & Examples
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../quick_start/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    🚀 Quick Start
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../complex_examples.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    🧩 Complex Examples
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    🎯 Motivation & Contribution
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            🎯 Motivation & Contribution
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../motivation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    🌍 Why KDP? (Motivation)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../contributing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    🍻 Contributing Guide
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    <span class="md-ellipsis">
      Overview
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#features" class="md-nav__link">
    <span class="md-ellipsis">
      Features
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Features">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#distribution-types-supported" class="md-nav__link">
    <span class="md-ellipsis">
      Distribution Types Supported
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#usage" class="md-nav__link">
    <span class="md-ellipsis">
      Usage
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Usage">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#basic-usage" class="md-nav__link">
    <span class="md-ellipsis">
      Basic Usage
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#advanced-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      Advanced Configuration
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#key-features" class="md-nav__link">
    <span class="md-ellipsis">
      Key Features
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Key Features">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-automatic-distribution-detection" class="md-nav__link">
    <span class="md-ellipsis">
      1. Automatic Distribution Detection
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-adaptive-transformations" class="md-nav__link">
    <span class="md-ellipsis">
      2. Adaptive Transformations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-fourier-feature-generation" class="md-nav__link">
    <span class="md-ellipsis">
      3. Fourier Feature Generation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-robust-handling" class="md-nav__link">
    <span class="md-ellipsis">
      4. Robust Handling
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#implementation-details" class="md-nav__link">
    <span class="md-ellipsis">
      Implementation Details
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Implementation Details">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-periodic-data-handling" class="md-nav__link">
    <span class="md-ellipsis">
      1. Periodic Data Handling
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-distribution-detection" class="md-nav__link">
    <span class="md-ellipsis">
      2. Distribution Detection
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-adaptive-parameters" class="md-nav__link">
    <span class="md-ellipsis">
      3. Adaptive Parameters
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#best-practices" class="md-nav__link">
    <span class="md-ellipsis">
      Best Practices
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#integration-with-preprocessing-pipeline" class="md-nav__link">
    <span class="md-ellipsis">
      Integration with Preprocessing Pipeline
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#performance-considerations" class="md-nav__link">
    <span class="md-ellipsis">
      Performance Considerations
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Performance Considerations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#memory-usage" class="md-nav__link">
    <span class="md-ellipsis">
      Memory Usage
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#computational-complexity" class="md-nav__link">
    <span class="md-ellipsis">
      Computational Complexity
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#best-practices_1" class="md-nav__link">
    <span class="md-ellipsis">
      Best Practices
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#example-use-cases" class="md-nav__link">
    <span class="md-ellipsis">
      Example Use Cases
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Example Use Cases">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-financial-data" class="md-nav__link">
    <span class="md-ellipsis">
      1. Financial Data
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-temporal-data" class="md-nav__link">
    <span class="md-ellipsis">
      2. Temporal Data
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-sparse-features" class="md-nav__link">
    <span class="md-ellipsis">
      3. Sparse Features
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#monitoring-and-debugging" class="md-nav__link">
    <span class="md-ellipsis">
      Monitoring and Debugging
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Monitoring and Debugging">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#distribution-detection" class="md-nav__link">
    <span class="md-ellipsis">
      Distribution Detection
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#transformation-quality" class="md-nav__link">
    <span class="md-ellipsis">
      Transformation Quality
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="distribution-aware-encoder">Distribution-Aware Encoder</h1>
<h2 id="overview">Overview</h2>
<p>The Distribution-Aware Encoder is an advanced preprocessing layer that automatically detects and handles various types of data distributions. It uses TensorFlow Probability (tfp) for accurate modeling and applies specialized transformations while preserving the statistical properties of the data.</p>
<h2 id="features">Features</h2>
<h3 id="distribution-types-supported">Distribution Types Supported</h3>
<ol>
<li><strong>Normal Distribution</strong></li>
<li>For standard normally distributed data</li>
<li>Handled via z-score normalization</li>
<li>
<p>Detection: Kurtosis ≈ 3.0, Skewness ≈ 0</p>
</li>
<li>
<p><strong>Heavy-Tailed Distribution</strong></p>
</li>
<li>For data with heavier tails than normal</li>
<li>Handled via Student's t-distribution</li>
<li>
<p>Detection: Kurtosis &gt; 3.5</p>
</li>
<li>
<p><strong>Multimodal Distribution</strong></p>
</li>
<li>For data with multiple peaks</li>
<li>Handled via Gaussian Mixture Models</li>
<li>
<p>Detection: KDE-based peak detection</p>
</li>
<li>
<p><strong>Uniform Distribution</strong></p>
</li>
<li>For evenly distributed data</li>
<li>Handled via min-max scaling</li>
<li>
<p>Detection: Kurtosis ≈ 1.8</p>
</li>
<li>
<p><strong>Exponential Distribution</strong></p>
</li>
<li>For data with exponential decay</li>
<li>Handled via rate-based transformation</li>
<li>
<p>Detection: Skewness ≈ 2.0</p>
</li>
<li>
<p><strong>Log-Normal Distribution</strong></p>
</li>
<li>For data that is normal after log transform</li>
<li>Handled via logarithmic transformation</li>
<li>
<p>Detection: Log-transformed kurtosis ≈ 3.0</p>
</li>
<li>
<p><strong>Discrete Distribution</strong></p>
</li>
<li>For data with finite distinct values</li>
<li>Handled via empirical CDF-based encoding</li>
<li>
<p>Detection: Unique values analysis</p>
</li>
<li>
<p><strong>Periodic Distribution</strong></p>
</li>
<li>For data with cyclic patterns</li>
<li>Handled via Fourier features (sin/cos)</li>
<li>
<p>Detection: Autocorrelation analysis</p>
</li>
<li>
<p><strong>Sparse Distribution</strong></p>
</li>
<li>For data with many zeros</li>
<li>Handled via separate zero/non-zero transformations</li>
<li>
<p>Detection: Zero ratio analysis</p>
</li>
<li>
<p><strong>Beta Distribution</strong></p>
<ul>
<li>For bounded data between 0 and 1</li>
<li>Handled via beta CDF transformation</li>
<li>Detection: Value range and shape analysis</li>
</ul>
</li>
<li>
<p><strong>Gamma Distribution</strong></p>
<ul>
<li>For positive, right-skewed data</li>
<li>Handled via gamma CDF transformation</li>
<li>Detection: Positive support and skewness</li>
</ul>
</li>
<li>
<p><strong>Poisson Distribution</strong></p>
<ul>
<li>For count data</li>
<li>Handled via rate parameter estimation</li>
<li>Detection: Integer values and variance≈mean</li>
</ul>
</li>
<li>
<p><strong>Weibull Distribution</strong></p>
<ul>
<li>For lifetime/failure data</li>
<li>Handled via Weibull CDF</li>
<li>Detection: Shape and scale analysis</li>
</ul>
</li>
<li>
<p><strong>Cauchy Distribution</strong></p>
<ul>
<li>For extremely heavy-tailed data</li>
<li>Handled via robust location-scale estimation</li>
<li>Detection: Undefined moments</li>
</ul>
</li>
<li>
<p><strong>Zero-Inflated Distribution</strong></p>
<ul>
<li>For data with excess zeros</li>
<li>Handled via mixture model approach</li>
<li>Detection: Zero proportion analysis</li>
</ul>
</li>
<li>
<p><strong>Bounded Distribution</strong></p>
<ul>
<li>For data with known bounds</li>
<li>Handled via scaled beta transformation</li>
<li>Detection: Value range analysis</li>
</ul>
</li>
<li>
<p><strong>Ordinal Distribution</strong></p>
<ul>
<li>For ordered categorical data</li>
<li>Handled via learned mapping</li>
<li>Detection: Discrete ordered values</li>
</ul>
</li>
</ol>
<h2 id="usage">Usage</h2>
<h3 id="basic-usage">Basic Usage</h3>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">kdp.processor</span><span class="w"> </span><span class="kn">import</span> <span class="n">PreprocessingModel</span>

<span class="n">preprocessor</span> <span class="o">=</span> <span class="n">PreprocessingModel</span><span class="p">(</span>
    <span class="n">features_stats</span><span class="o">=</span><span class="n">stats</span><span class="p">,</span>
    <span class="n">features_specs</span><span class="o">=</span><span class="n">specs</span><span class="p">,</span>
    <span class="n">use_distribution_aware</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
</code></pre></div>
<h3 id="advanced-configuration">Advanced Configuration</h3>
<div class="highlight"><pre><span></span><code><span class="n">encoder</span> <span class="o">=</span> <span class="n">DistributionAwareEncoder</span><span class="p">(</span>
    <span class="n">num_bins</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>
    <span class="n">epsilon</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">,</span>
    <span class="n">detect_periodicity</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">handle_sparsity</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">adaptive_binning</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">mixture_components</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
    <span class="n">trainable</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
</code></pre></div>
<h2 id="parameters">Parameters</h2>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>num_bins</td>
<td>int</td>
<td>1000</td>
<td>Number of bins for quantile encoding</td>
</tr>
<tr>
<td>epsilon</td>
<td>float</td>
<td>1e-6</td>
<td>Small value for numerical stability</td>
</tr>
<tr>
<td>detect_periodicity</td>
<td>bool</td>
<td>True</td>
<td>Enable periodic pattern detection</td>
</tr>
<tr>
<td>handle_sparsity</td>
<td>bool</td>
<td>True</td>
<td>Enable special handling for sparse data</td>
</tr>
<tr>
<td>adaptive_binning</td>
<td>bool</td>
<td>True</td>
<td>Enable adaptive bin boundaries</td>
</tr>
<tr>
<td>mixture_components</td>
<td>int</td>
<td>3</td>
<td>Number of components for mixture models</td>
</tr>
<tr>
<td>trainable</td>
<td>bool</td>
<td>True</td>
<td>Whether parameters are trainable</td>
</tr>
</tbody>
</table>
<h2 id="key-features">Key Features</h2>
<h3 id="1-automatic-distribution-detection">1. Automatic Distribution Detection</h3>
<ul>
<li>Uses statistical moments and tests</li>
<li>Employs KDE for multimodality detection</li>
<li>Handles mixed distributions via ensemble approach</li>
</ul>
<h3 id="2-adaptive-transformations">2. Adaptive Transformations</h3>
<ul>
<li>Learns optimal parameters during training</li>
<li>Adjusts to data distribution changes</li>
<li>Handles complex periodic patterns</li>
</ul>
<h3 id="3-fourier-feature-generation">3. Fourier Feature Generation</h3>
<ul>
<li>Automatic frequency detection</li>
<li>Multiple harmonic components</li>
<li>Phase-aware transformations</li>
</ul>
<h3 id="4-robust-handling">4. Robust Handling</h3>
<ul>
<li>Special treatment for zeros</li>
<li>Outlier-resistant transformations</li>
<li>Numerical stability safeguards</li>
</ul>
<h2 id="implementation-details">Implementation Details</h2>
<h3 id="1-periodic-data-handling">1. Periodic Data Handling</h3>
<div class="highlight"><pre><span></span><code><span class="c1"># Normalize to [-π, π] range</span>
<span class="n">normalized</span> <span class="o">=</span> <span class="n">inputs</span> <span class="o">*</span> <span class="n">π</span> <span class="o">/</span> <span class="n">scale</span>
<span class="c1"># Generate Fourier features</span>
<span class="n">features</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">sin</span><span class="p">(</span><span class="n">freq</span> <span class="o">*</span> <span class="n">normalized</span> <span class="o">+</span> <span class="n">phase</span><span class="p">),</span>
    <span class="n">cos</span><span class="p">(</span><span class="n">freq</span> <span class="o">*</span> <span class="n">normalized</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span>
<span class="p">]</span>
<span class="c1"># Add harmonics if multimodal</span>
<span class="k">if</span> <span class="n">is_multimodal</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]:</span>
        <span class="n">features</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span>
            <span class="n">sin</span><span class="p">(</span><span class="n">h</span> <span class="o">*</span> <span class="n">freq</span> <span class="o">*</span> <span class="n">normalized</span> <span class="o">+</span> <span class="n">phase</span><span class="p">),</span>
            <span class="n">cos</span><span class="p">(</span><span class="n">h</span> <span class="o">*</span> <span class="n">freq</span> <span class="o">*</span> <span class="n">normalized</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span>
        <span class="p">])</span>
</code></pre></div>
<h3 id="2-distribution-detection">2. Distribution Detection</h3>
<div class="highlight"><pre><span></span><code><span class="c1"># Statistical moments</span>
<span class="n">mean</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">reduce_mean</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
<span class="n">variance</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">math</span><span class="o">.</span><span class="n">reduce_variance</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
<span class="n">skewness</span> <span class="o">=</span> <span class="n">compute_skewness</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
<span class="n">kurtosis</span> <span class="o">=</span> <span class="n">compute_kurtosis</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>

<span class="c1"># Distribution tests</span>
<span class="n">is_normal</span> <span class="o">=</span> <span class="n">test_normality</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
<span class="n">is_multimodal</span> <span class="o">=</span> <span class="n">detect_multimodality</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
<span class="n">is_periodic</span> <span class="o">=</span> <span class="n">check_periodicity</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
</code></pre></div>
<h3 id="3-adaptive-parameters">3. Adaptive Parameters</h3>
<div class="highlight"><pre><span></span><code><span class="bp">self</span><span class="o">.</span><span class="n">boundaries</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_weight</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;boundaries&quot;</span><span class="p">,</span>
    <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">num_bins</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,),</span>
    <span class="n">initializer</span><span class="o">=</span><span class="s2">&quot;zeros&quot;</span><span class="p">,</span>
    <span class="n">trainable</span><span class="o">=</span><span class="n">adaptive_binning</span>
<span class="p">)</span>

<span class="bp">self</span><span class="o">.</span><span class="n">mixture_weights</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_weight</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;mixture_weights&quot;</span><span class="p">,</span>
    <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">mixture_components</span><span class="p">,),</span>
    <span class="n">initializer</span><span class="o">=</span><span class="s2">&quot;ones&quot;</span><span class="p">,</span>
    <span class="n">trainable</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
</code></pre></div>
<h2 id="best-practices">Best Practices</h2>
<ol>
<li><strong>Data Preparation</strong></li>
<li>Clean obvious outliers</li>
<li>Handle missing values</li>
<li>
<p>Ensure numeric data types</p>
</li>
<li>
<p><strong>Configuration</strong></p>
</li>
<li>Enable periodicity detection for time-related features</li>
<li>Use adaptive binning for changing distributions</li>
<li>
<p>Adjust mixture components based on complexity</p>
</li>
<li>
<p><strong>Performance</strong></p>
</li>
<li>Use appropriate batch sizes</li>
<li>Enable caching when possible</li>
<li>
<p>Monitor transformation times</p>
</li>
<li>
<p><strong>Monitoring</strong></p>
</li>
<li>Check distribution detection accuracy</li>
<li>Validate transformation quality</li>
<li>Watch for numerical instabilities</li>
</ol>
<h2 id="integration-with-preprocessing-pipeline">Integration with Preprocessing Pipeline</h2>
<p>The DistributionAwareEncoder is integrated into the numeric feature processing pipeline:</p>
<ol>
<li><strong>Feature Statistics Collection</strong></li>
<li>Basic statistics (mean, variance)</li>
<li>Distribution characteristics</li>
<li>
<p>Sparsity patterns</p>
</li>
<li>
<p><strong>Automatic Distribution Detection</strong></p>
</li>
<li>Statistical tests</li>
<li>Pattern recognition</li>
<li>
<p>Threshold-based decisions</p>
</li>
<li>
<p><strong>Dynamic Transformation</strong></p>
</li>
<li>Distribution-specific handling</li>
<li>Adaptive parameter adjustment</li>
<li>Quality monitoring</li>
</ol>
<h2 id="performance-considerations">Performance Considerations</h2>
<h3 id="memory-usage">Memory Usage</h3>
<ul>
<li>Adaptive binning weights: O(num_bins)</li>
<li>GMM parameters: O(mixture_components)</li>
<li>Periodic components: O(1)</li>
</ul>
<h3 id="computational-complexity">Computational Complexity</h3>
<ul>
<li>Distribution detection: O(n)</li>
<li>Transformation: O(n)</li>
<li>GMM fitting: O(n * mixture_components)</li>
</ul>
<h2 id="best-practices_1">Best Practices</h2>
<ol>
<li><strong>Data Preparation</strong></li>
<li>Clean outliers if not meaningful</li>
<li>Handle missing values before encoding</li>
<li>
<p>Ensure numeric data type</p>
</li>
<li>
<p><strong>Configuration</strong></p>
</li>
<li>Start with default parameters</li>
<li>Adjust based on data characteristics</li>
<li>
<p>Monitor distribution detection results</p>
</li>
<li>
<p><strong>Performance Optimization</strong></p>
</li>
<li>Use appropriate batch sizes</li>
<li>Enable caching for repeated processing</li>
<li>Adjust mixture components based on data</li>
</ol>
<h2 id="example-use-cases">Example Use Cases</h2>
<h3 id="1-financial-data">1. Financial Data</h3>
<div class="highlight"><pre><span></span><code><span class="c1"># Handle heavy-tailed return distributions</span>
<span class="n">preprocessor</span> <span class="o">=</span> <span class="n">PreprocessingModel</span><span class="p">(</span>
    <span class="n">use_distribution_aware</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">handle_sparsity</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">mixture_components</span><span class="o">=</span><span class="mi">2</span>
<span class="p">)</span>
</code></pre></div>
<h3 id="2-temporal-data">2. Temporal Data</h3>
<div class="highlight"><pre><span></span><code><span class="c1"># Handle periodic patterns</span>
<span class="n">preprocessor</span> <span class="o">=</span> <span class="n">PreprocessingModel</span><span class="p">(</span>
    <span class="n">use_distribution_aware</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">detect_periodicity</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">adaptive_binning</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
</code></pre></div>
<h3 id="3-sparse-features">3. Sparse Features</h3>
<div class="highlight"><pre><span></span><code><span class="c1"># Handle sparse categorical data</span>
<span class="n">preprocessor</span> <span class="o">=</span> <span class="n">PreprocessingModel</span><span class="p">(</span>
    <span class="n">use_distribution_aware</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">handle_sparsity</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">mixture_components</span><span class="o">=</span><span class="mi">1</span>
<span class="p">)</span>
</code></pre></div>
<h2 id="monitoring-and-debugging">Monitoring and Debugging</h2>
<h3 id="distribution-detection">Distribution Detection</h3>
<div class="highlight"><pre><span></span><code><span class="c1"># Access distribution information</span>
<span class="n">dist_info</span> <span class="o">=</span> <span class="n">encoder</span><span class="o">.</span><span class="n">_estimate_distribution</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Detected distribution: </span><span class="si">{</span><span class="n">dist_info</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Statistics: </span><span class="si">{</span><span class="n">dist_info</span><span class="p">[</span><span class="s1">&#39;stats&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>
<h3 id="transformation-quality">Transformation Quality</h3>
<div class="highlight"><pre><span></span><code><span class="c1"># Monitor transformed output statistics</span>
<span class="n">transformed</span> <span class="o">=</span> <span class="n">encoder</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Output mean: </span><span class="si">{</span><span class="n">tf</span><span class="o">.</span><span class="n">reduce_mean</span><span class="p">(</span><span class="n">transformed</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Output variance: </span><span class="si">{</span><span class="n">tf</span><span class="o">.</span><span class="n">math</span><span class="o">.</span><span class="n">reduce_variance</span><span class="p">(</span><span class="n">transformed</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../assets/javascripts/bundle.5090c770.min.js"></script>
      
    
  </body>
</html>