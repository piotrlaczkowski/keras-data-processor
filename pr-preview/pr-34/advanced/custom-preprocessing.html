
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://example.com/kdp/advanced/custom-preprocessing.html">
      
      
        <link rel="prev" href="feature-moe.html">
      
      
        <link rel="next" href="../optimization/feature-selection.html">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.16">
    
    
      
        <title>üõ†Ô∏è Custom Preprocessing Pipelines - KDP - Keras Data Preprocessor</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.7e37652d.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      
  
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
  
  <style>:root{--md-admonition-icon--note:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M1%207.775V2.75C1%201.784%201.784%201%202.75%201h5.025c.464%200%20.91.184%201.238.513l6.25%206.25a1.75%201.75%200%200%201%200%202.474l-5.026%205.026a1.75%201.75%200%200%201-2.474%200l-6.25-6.25A1.75%201.75%200%200%201%201%207.775m1.5%200c0%20.066.026.13.073.177l6.25%206.25a.25.25%200%200%200%20.354%200l5.025-5.025a.25.25%200%200%200%200-.354l-6.25-6.25a.25.25%200%200%200-.177-.073H2.75a.25.25%200%200%200-.25.25ZM6%205a1%201%200%201%201%200%202%201%201%200%200%201%200-2%22/%3E%3C/svg%3E');--md-admonition-icon--abstract:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M2.5%201.75v11.5c0%20.138.112.25.25.25h3.17a.75.75%200%200%201%200%201.5H2.75A1.75%201.75%200%200%201%201%2013.25V1.75C1%20.784%201.784%200%202.75%200h8.5C12.216%200%2013%20.784%2013%201.75v7.736a.75.75%200%200%201-1.5%200V1.75a.25.25%200%200%200-.25-.25h-8.5a.25.25%200%200%200-.25.25m13.274%209.537zl-4.557%204.45a.75.75%200%200%201-1.055-.008l-1.943-1.95a.75.75%200%200%201%201.062-1.058l1.419%201.425%204.026-3.932a.75.75%200%201%201%201.048%201.074M4.75%204h4.5a.75.75%200%200%201%200%201.5h-4.5a.75.75%200%200%201%200-1.5M4%207.75A.75.75%200%200%201%204.75%207h2a.75.75%200%200%201%200%201.5h-2A.75.75%200%200%201%204%207.75%22/%3E%3C/svg%3E');--md-admonition-icon--info:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M0%208a8%208%200%201%201%2016%200A8%208%200%200%201%200%208m8-6.5a6.5%206.5%200%201%200%200%2013%206.5%206.5%200%200%200%200-13M6.5%207.75A.75.75%200%200%201%207.25%207h1a.75.75%200%200%201%20.75.75v2.75h.25a.75.75%200%200%201%200%201.5h-2a.75.75%200%200%201%200-1.5h.25v-2h-.25a.75.75%200%200%201-.75-.75M8%206a1%201%200%201%201%200-2%201%201%200%200%201%200%202%22/%3E%3C/svg%3E');--md-admonition-icon--tip:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M3.499.75a.75.75%200%200%201%201.5%200v.996C5.9%202.903%206.793%203.65%207.662%204.376l.24.202c-.036-.694.055-1.422.426-2.163C9.1.873%2010.794-.045%2012.622.26%2014.408.558%2016%201.94%2016%204.25c0%201.278-.954%202.575-2.44%202.734l.146.508.065.22c.203.701.412%201.455.476%202.226.142%201.707-.4%203.03-1.487%203.898C11.714%2014.671%2010.27%2015%208.75%2015h-6a.75.75%200%200%201%200-1.5h1.376a4.5%204.5%200%200%201-.563-1.191%203.84%203.84%200%200%201-.05-2.063%204.65%204.65%200%200%201-2.025-.293.75.75%200%200%201%20.525-1.406c1.357.507%202.376-.006%202.698-.318l.009-.01a.747.747%200%200%201%201.06%200%20.75.75%200%200%201-.012%201.074c-.912.92-.992%201.835-.768%202.586.221.74.745%201.337%201.196%201.621H8.75c1.343%200%202.398-.296%203.074-.836.635-.507%201.036-1.31.928-2.602-.05-.603-.216-1.224-.422-1.93l-.064-.221c-.12-.407-.246-.84-.353-1.29a2.4%202.4%200%200%201-.507-.441%203.1%203.1%200%200%201-.633-1.248.75.75%200%200%201%201.455-.364c.046.185.144.436.31.627.146.168.353.305.712.305.738%200%201.25-.615%201.25-1.25%200-1.47-.95-2.315-2.123-2.51-1.172-.196-2.227.387-2.706%201.345-.46.92-.27%201.774.019%203.062l.042.19.01.05c.348.443.666.949.94%201.553a.75.75%200%201%201-1.365.62c-.553-1.217-1.32-1.94-2.3-2.768L6.7%205.527c-.814-.68-1.75-1.462-2.692-2.619a3.7%203.7%200%200%200-1.023.88c-.406.495-.663%201.036-.722%201.508.116.122.306.21.591.239.388.038.797-.06%201.032-.19a.75.75%200%200%201%20.728%201.31c-.515.287-1.23.439-1.906.373-.682-.067-1.473-.38-1.879-1.193L.75%205.677V5.5c0-.984.48-1.94%201.077-2.664.46-.559%201.05-1.055%201.673-1.353z%22/%3E%3C/svg%3E');--md-admonition-icon--success:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M13.78%204.22a.75.75%200%200%201%200%201.06l-7.25%207.25a.75.75%200%200%201-1.06%200L2.22%209.28a.75.75%200%200%201%20.018-1.042.75.75%200%200%201%201.042-.018L6%2010.94l6.72-6.72a.75.75%200%200%201%201.06%200%22/%3E%3C/svg%3E');--md-admonition-icon--question:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M0%208a8%208%200%201%201%2016%200A8%208%200%200%201%200%208m8-6.5a6.5%206.5%200%201%200%200%2013%206.5%206.5%200%200%200%200-13M6.92%206.085h.001a.749.749%200%201%201-1.342-.67c.169-.339.436-.701.849-.977C6.845%204.16%207.369%204%208%204a2.76%202.76%200%200%201%201.637.525c.503.377.863.965.863%201.725%200%20.448-.115.83-.329%201.15-.205.307-.47.513-.692.662-.109.072-.22.138-.313.195l-.006.004a6%206%200%200%200-.26.16%201%201%200%200%200-.276.245.75.75%200%200%201-1.248-.832c.184-.264.42-.489.692-.661q.154-.1.313-.195l.007-.004c.1-.061.182-.11.258-.161a1%201%200%200%200%20.277-.245C8.96%206.514%209%206.427%209%206.25a.61.61%200%200%200-.262-.525A1.27%201.27%200%200%200%208%205.5c-.369%200-.595.09-.74.187a1%201%200%200%200-.34.398M9%2011a1%201%200%201%201-2%200%201%201%200%200%201%202%200%22/%3E%3C/svg%3E');--md-admonition-icon--warning:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M6.457%201.047c.659-1.234%202.427-1.234%203.086%200l6.082%2011.378A1.75%201.75%200%200%201%2014.082%2015H1.918a1.75%201.75%200%200%201-1.543-2.575Zm1.763.707a.25.25%200%200%200-.44%200L1.698%2013.132a.25.25%200%200%200%20.22.368h12.164a.25.25%200%200%200%20.22-.368Zm.53%203.996v2.5a.75.75%200%200%201-1.5%200v-2.5a.75.75%200%200%201%201.5%200M9%2011a1%201%200%201%201-2%200%201%201%200%200%201%202%200%22/%3E%3C/svg%3E');--md-admonition-icon--failure:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M2.344%202.343za8%208%200%200%201%2011.314%2011.314A8.002%208.002%200%200%201%20.234%2010.089a8%208%200%200%201%202.11-7.746m1.06%2010.253a6.5%206.5%200%201%200%209.108-9.275%206.5%206.5%200%200%200-9.108%209.275M6.03%204.97%208%206.94l1.97-1.97a.749.749%200%200%201%201.275.326.75.75%200%200%201-.215.734L9.06%208l1.97%201.97a.749.749%200%200%201-.326%201.275.75.75%200%200%201-.734-.215L8%209.06l-1.97%201.97a.749.749%200%200%201-1.275-.326.75.75%200%200%201%20.215-.734L6.94%208%204.97%206.03a.75.75%200%200%201%20.018-1.042.75.75%200%200%201%201.042-.018%22/%3E%3C/svg%3E');--md-admonition-icon--danger:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M9.504.43a1.516%201.516%200%200%201%202.437%201.713L10.415%205.5h2.123c1.57%200%202.346%201.909%201.22%203.004l-7.34%207.142a1.25%201.25%200%200%201-.871.354h-.302a1.25%201.25%200%200%201-1.157-1.723L5.633%2010.5H3.462c-1.57%200-2.346-1.909-1.22-3.004zm1.047%201.074L3.286%208.571A.25.25%200%200%200%203.462%209H6.75a.75.75%200%200%201%20.694%201.034l-1.713%204.188%206.982-6.793A.25.25%200%200%200%2012.538%207H9.25a.75.75%200%200%201-.683-1.06l2.008-4.418.003-.006-.004-.009-.006-.006-.008-.001q-.005%200-.009.004%22/%3E%3C/svg%3E');--md-admonition-icon--bug:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M4.72.22a.75.75%200%200%201%201.06%200l1%20.999a3.5%203.5%200%200%201%202.441%200l.999-1a.748.748%200%200%201%201.265.332.75.75%200%200%201-.205.729l-.775.776c.616.63.995%201.493.995%202.444v.327q0%20.15-.025.292c.408.14.764.392%201.029.722l1.968-.787a.75.75%200%200%201%20.556%201.392L13%207.258V9h2.25a.75.75%200%200%201%200%201.5H13v.5q-.002.615-.141%201.186l2.17.868a.75.75%200%200%201-.557%201.392l-2.184-.873A5%205%200%200%201%208%2016a5%205%200%200%201-4.288-2.427l-2.183.873a.75.75%200%200%201-.558-1.392l2.17-.868A5%205%200%200%201%203%2011v-.5H.75a.75.75%200%200%201%200-1.5H3V7.258L.971%206.446a.75.75%200%200%201%20.558-1.392l1.967.787c.265-.33.62-.583%201.03-.722a1.7%201.7%200%200%201-.026-.292V4.5c0-.951.38-1.814.995-2.444L4.72%201.28a.75.75%200%200%201%200-1.06m.53%206.28a.75.75%200%200%200-.75.75V11a3.5%203.5%200%201%200%207%200V7.25a.75.75%200%200%200-.75-.75ZM6.173%205h3.654A.17.17%200%200%200%2010%204.827V4.5a2%202%200%201%200-4%200v.327c0%20.096.077.173.173.173%22/%3E%3C/svg%3E');--md-admonition-icon--example:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M5%205.782V2.5h-.25a.75.75%200%200%201%200-1.5h6.5a.75.75%200%200%201%200%201.5H11v3.282l3.666%205.76C15.619%2013.04%2014.543%2015%2012.767%2015H3.233c-1.776%200-2.852-1.96-1.899-3.458Zm-2.4%206.565a.75.75%200%200%200%20.633%201.153h9.534a.75.75%200%200%200%20.633-1.153L12.225%2010.5h-8.45ZM9.5%202.5h-3V6c0%20.143-.04.283-.117.403L4.73%209h6.54L9.617%206.403A.75.75%200%200%201%209.5%206Z%22/%3E%3C/svg%3E');--md-admonition-icon--quote:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M1.75%202.5h10.5a.75.75%200%200%201%200%201.5H1.75a.75.75%200%200%201%200-1.5m4%205h8.5a.75.75%200%200%201%200%201.5h-8.5a.75.75%200%200%201%200-1.5m0%205h8.5a.75.75%200%200%201%200%201.5h-8.5a.75.75%200%200%201%200-1.5M2.5%207.75v6a.75.75%200%200%201-1.5%200v-6a.75.75%200%200%201%201.5%200%22/%3E%3C/svg%3E');}</style>



    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent="black">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#custom-preprocessing-pipelines" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../index.html" title="KDP - Keras Data Preprocessor" class="md-header__button md-logo" aria-label="KDP - Keras Data Preprocessor" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 11a1 1 0 0 1 1 1 1 1 0 0 1-1 1 1 1 0 0 1-1-1 1 1 0 0 1 1-1M4.22 4.22C5.65 2.79 8.75 3.43 12 5.56c3.25-2.13 6.35-2.77 7.78-1.34s.79 4.53-1.34 7.78c2.13 3.25 2.77 6.35 1.34 7.78s-4.53.79-7.78-1.34c-3.25 2.13-6.35 2.77-7.78 1.34S3.43 15.25 5.56 12C3.43 8.75 2.79 5.65 4.22 4.22m11.32 4.24c.61.62 1.17 1.25 1.69 1.88 1.38-2.13 1.88-3.96 1.13-4.7-.74-.75-2.57-.25-4.7 1.13.63.52 1.26 1.08 1.88 1.69m-7.08 7.08c-.61-.62-1.17-1.25-1.69-1.88-1.38 2.13-1.88 3.96-1.13 4.7.74.75 2.57.25 4.7-1.13-.63-.52-1.26-1.08-1.88-1.69m-2.82-9.9c-.75.74-.25 2.57 1.13 4.7.52-.63 1.08-1.26 1.69-1.88.62-.61 1.25-1.17 1.88-1.69-2.13-1.38-3.96-1.88-4.7-1.13m4.24 8.48c.7.7 1.42 1.34 2.12 1.91.7-.57 1.42-1.21 2.12-1.91s1.34-1.42 1.91-2.12c-.57-.7-1.21-1.42-1.91-2.12S12.7 8.54 12 7.97c-.7.57-1.42 1.21-2.12 1.91S8.54 11.3 7.97 12c.57.7 1.21 1.42 1.91 2.12m8.48 4.24c.75-.74.25-2.57-1.13-4.7-.52.63-1.08 1.26-1.69 1.88-.62.61-1.25 1.17-1.88 1.69 2.13 1.38 3.96 1.88 4.7 1.13"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            KDP - Keras Data Preprocessor
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              üõ†Ô∏è Custom Preprocessing Pipelines
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent="black"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="teal" data-md-color-accent="teal"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/piotrlaczkowski/keras-data-processor" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    Keras Data Preprocessor
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../index.html" title="KDP - Keras Data Preprocessor" class="md-nav__button md-logo" aria-label="KDP - Keras Data Preprocessor" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 11a1 1 0 0 1 1 1 1 1 0 0 1-1 1 1 1 0 0 1-1-1 1 1 0 0 1 1-1M4.22 4.22C5.65 2.79 8.75 3.43 12 5.56c3.25-2.13 6.35-2.77 7.78-1.34s.79 4.53-1.34 7.78c2.13 3.25 2.77 6.35 1.34 7.78s-4.53.79-7.78-1.34c-3.25 2.13-6.35 2.77-7.78 1.34S3.43 15.25 5.56 12C3.43 8.75 2.79 5.65 4.22 4.22m11.32 4.24c.61.62 1.17 1.25 1.69 1.88 1.38-2.13 1.88-3.96 1.13-4.7-.74-.75-2.57-.25-4.7 1.13.63.52 1.26 1.08 1.88 1.69m-7.08 7.08c-.61-.62-1.17-1.25-1.69-1.88-1.38 2.13-1.88 3.96-1.13 4.7.74.75 2.57.25 4.7-1.13-.63-.52-1.26-1.08-1.88-1.69m-2.82-9.9c-.75.74-.25 2.57 1.13 4.7.52-.63 1.08-1.26 1.69-1.88.62-.61 1.25-1.17 1.88-1.69-2.13-1.38-3.96-1.88-4.7-1.13m4.24 8.48c.7.7 1.42 1.34 2.12 1.91.7-.57 1.42-1.21 2.12-1.91s1.34-1.42 1.91-2.12c-.57-.7-1.21-1.42-1.91-2.12S12.7 8.54 12 7.97c-.7.57-1.42 1.21-2.12 1.91S8.54 11.3 7.97 12c.57.7 1.21 1.42 1.91 2.12m8.48 4.24c.75-.74.25-2.57-1.13-4.7-.52.63-1.08 1.26-1.69 1.88-.62.61-1.25 1.17-1.88 1.69 2.13 1.38 3.96 1.88 4.7 1.13"/></svg>

    </a>
    KDP - Keras Data Preprocessor
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/piotrlaczkowski/keras-data-processor" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    Keras Data Preprocessor
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    üè† Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    üöÄ Getting Started
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            üöÄ Getting Started
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../getting-started/installation.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    üì¶ Installation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../getting-started/quick-start.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    üéØ Quick Start
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../getting-started/motivation.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    üåç Why KDP?
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../getting-started/architecture.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    üß© Architecture Overview
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    üìö Feature Types
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            üìö Feature Types
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../features/overview.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    üõ†Ô∏è Features Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../features/numerical-features.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    üî¢ Numerical Features
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../features/categorical-features.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    üè∑Ô∏è Categorical Features
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../features/text-features.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    üìù Text Features
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../features/date-features.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    üìÖ Date Features
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../features/time_series_features.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    üìä Time Series Features
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../features/cross-features.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ‚ûï Cross Features
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../features/passthrough-features.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    üîÑ Passthrough Features
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    üß† Advanced Features
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            üß† Advanced Features
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="distribution-aware-encoding.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    üìä Distribution-Aware Encoding
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="numerical-embeddings.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    üî¢ Advanced Numerical Embeddings
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="tabular-attention.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    üëÅÔ∏è Tabular Attention
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="transformer-blocks.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ü§ñ Transformer Blocks
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="feature-moe.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    üß© Feature-wise Mixture of Experts
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    üõ†Ô∏è Custom Preprocessing Pipelines
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="custom-preprocessing.html" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    üõ†Ô∏è Custom Preprocessing Pipelines
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    <span class="md-ellipsis">
      üìã Overview
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#key-benefits" class="md-nav__link">
    <span class="md-ellipsis">
      ‚ú® Key Benefits
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#getting-started" class="md-nav__link">
    <span class="md-ellipsis">
      üöÄ Getting Started
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    ‚ö° Optimization
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            ‚ö° Optimization
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../optimization/feature-selection.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    üéØ Feature Selection
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../optimization/tabular-optimization.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    üìà Tabular Optimization
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../optimization/auto-configuration.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ‚öôÔ∏è Auto-Configuration
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    üìñ Examples
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            üìñ Examples
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/basic-examples.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    üß™ Basic Examples
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/complex-examples.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    üî• Complex Examples
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/categorical-hashing-example.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    üßÆ Categorical Hashing
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    üîå Integration
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            üîå Integration
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../integrations/overview.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    üîÑ Integration Overview
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    ü§ù Contributing
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            ü§ù Contributing
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../contributing/overview.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    üçª Contributing Guide
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../contributing/development/auto-documentation.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    üìù Auto-Documentation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../contributing/development/images-organization.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    üñºÔ∏è Images Organization
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" >
        
          
          <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    üìë API Reference
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            üìë API Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/layers-factory.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    üè≠ Layers Factory
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated/api_index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    üìö API Index
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    <span class="md-ellipsis">
      üìã Overview
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#key-benefits" class="md-nav__link">
    <span class="md-ellipsis">
      ‚ú® Key Benefits
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#getting-started" class="md-nav__link">
    <span class="md-ellipsis">
      üöÄ Getting Started
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="custom-preprocessing-pipelines">üõ†Ô∏è Custom Preprocessing Pipelines</h1>
<div class="intro-container">
  <div class="intro-content">
    <h2>Create specialized preprocessing flows with complete control</h2>
    <p>Design custom transformations for your features when standard preprocessing doesn't meet your specific needs.</p>
  </div>
</div>

<h2 id="overview">üìã Overview</h2>
<div class="overview-card">
  <p>KDP allows you to define custom preprocessing pipelines for your features, giving you complete control over how each feature is processed before being fed into your model. This is particularly useful when the standard preprocessing options don't meet your specific needs.</p>
</div>

<h2 id="key-benefits">‚ú® Key Benefits</h2>
<div class="grid-container">
  <div class="grid-item">
    <span class="feature-icon">üîç</span>
    <h3>Specific Transformations</h3>
    <p>Define custom preprocessing steps not covered by built-in options</p>
  </div>
  <div class="grid-item">
    <span class="feature-icon">üîÑ</span>
    <h3>Combined Techniques</h3>
    <p>Combine multiple preprocessing techniques in a single pipeline</p>
  </div>
  <div class="grid-item">
    <span class="feature-icon">üß™</span>
    <h3>Domain-Specific</h3>
    <p>Handle specialized data with custom preprocessing logic</p>
  </div>
  <div class="grid-item">
    <span class="feature-icon">üî¨</span>
    <h3>Novel Approaches</h3>
    <p>Experiment with new preprocessing methods</p>
  </div>
  <div class="grid-item">
    <span class="feature-icon">üß©</span>
    <h3>Legacy Integration</h3>
    <p>Incorporate existing preprocessing logic</p>
  </div>
</div>

<h2 id="getting-started">üöÄ Getting Started</h2>
<div class="step-card">
  <div class="step-header">
    <span class="step-number">1</span>
    <h3>Basic Example</h3>
  </div>
  <div class="code-container">

<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">kdp.features</span><span class="w"> </span><span class="kn">import</span> <span class="n">NumericalFeature</span><span class="p">,</span> <span class="n">FeatureType</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">tensorflow.keras.layers</span><span class="w"> </span><span class="kn">import</span> <span class="n">Normalization</span><span class="p">,</span> <span class="n">Dense</span><span class="p">,</span> <span class="n">Activation</span>

<span class="c1"># Create a feature with custom preprocessing steps</span>
<span class="n">log_transform_feature</span> <span class="o">=</span> <span class="n">NumericalFeature</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;revenue&quot;</span><span class="p">,</span>
    <span class="n">feature_type</span><span class="o">=</span><span class="n">FeatureType</span><span class="o">.</span><span class="n">FLOAT_NORMALIZED</span><span class="p">,</span>
    <span class="n">preprocessors</span><span class="o">=</span><span class="p">[</span>
        <span class="s2">&quot;Lambda&quot;</span><span class="p">,</span>  <span class="c1"># Using a standard Keras layer by name</span>
        <span class="s2">&quot;Dense&quot;</span><span class="p">,</span>   <span class="c1"># Another standard layer</span>
        <span class="s2">&quot;ReLU&quot;</span>     <span class="c1"># Activation function</span>
    <span class="p">],</span>
    <span class="c1"># Parameters for the layers</span>
    <span class="n">function</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">math</span><span class="o">.</span><span class="n">log1p</span><span class="p">(</span><span class="n">x</span><span class="p">),</span>  <span class="c1"># For Lambda layer</span>
    <span class="n">units</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span>  <span class="c1"># For Dense layer</span>
<span class="p">)</span>
</code></pre></div>

</div>

## ü§î When to Use Custom Preprocessing

Consider using custom preprocessing pipelines when:

- üîç You need specific transformations not covered by the built-in options
- üîÑ You want to combine multiple preprocessing techniques
- üß™ You're working with domain-specific data that requires specialized handling
- üî¨ You want to experiment with novel preprocessing approaches
- üß© You have legacy preprocessing logic that you want to incorporate

## üì¶ Custom Preprocessors with PreprocessingModel

### üèÅ Basic Approach

The simplest way to define custom preprocessing is by specifying a list of preprocessors when creating a feature:

<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">kdp.features</span><span class="w"> </span><span class="kn">import</span> <span class="n">NumericalFeature</span><span class="p">,</span> <span class="n">FeatureType</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">tensorflow.keras.layers</span><span class="w"> </span><span class="kn">import</span> <span class="n">Normalization</span><span class="p">,</span> <span class="n">Dense</span><span class="p">,</span> <span class="n">Activation</span>

<span class="c1"># Create a feature with custom preprocessing steps</span>
<span class="n">log_transform_feature</span> <span class="o">=</span> <span class="n">NumericalFeature</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;revenue&quot;</span><span class="p">,</span>
    <span class="n">feature_type</span><span class="o">=</span><span class="n">FeatureType</span><span class="o">.</span><span class="n">FLOAT_NORMALIZED</span><span class="p">,</span>
    <span class="n">preprocessors</span><span class="o">=</span><span class="p">[</span>
        <span class="s2">&quot;Lambda&quot;</span><span class="p">,</span>  <span class="c1"># Using a standard Keras layer by name</span>
        <span class="s2">&quot;Dense&quot;</span><span class="p">,</span>   <span class="c1"># Another standard layer</span>
        <span class="s2">&quot;ReLU&quot;</span>     <span class="c1"># Activation function</span>
    <span class="p">],</span>
    <span class="c1"># Parameters for the layers</span>
    <span class="n">function</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">math</span><span class="o">.</span><span class="n">log1p</span><span class="p">(</span><span class="n">x</span><span class="p">),</span>  <span class="c1"># For Lambda layer</span>
    <span class="n">units</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span>  <span class="c1"># For Dense layer</span>
<span class="p">)</span>
</code></pre></div>

### üöÄ Advanced Usage with Layer Parameters

For more control, you can provide specific parameters to each preprocessing layer:

<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">kdp.features</span><span class="w"> </span><span class="kn">import</span> <span class="n">CategoricalFeature</span><span class="p">,</span> <span class="n">FeatureType</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">kdp.layers_factory</span><span class="w"> </span><span class="kn">import</span> <span class="n">PreprocessorLayerFactory</span>

<span class="c1"># Advanced categorical feature with custom preprocessing</span>
<span class="n">advanced_categorical</span> <span class="o">=</span> <span class="n">CategoricalFeature</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;product_category&quot;</span><span class="p">,</span>
    <span class="n">feature_type</span><span class="o">=</span><span class="n">FeatureType</span><span class="o">.</span><span class="n">STRING_CATEGORICAL</span><span class="p">,</span>
    <span class="n">preprocessors</span><span class="o">=</span><span class="p">[</span>
        <span class="s2">&quot;StringLookup&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Embedding&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Dropout&quot;</span>
    <span class="p">],</span>
    <span class="c1"># Parameters for layers</span>
    <span class="n">num_oov_indices</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>  <span class="c1"># For StringLookup</span>
    <span class="n">input_dim</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>      <span class="c1"># For Embedding</span>
    <span class="n">output_dim</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span>      <span class="c1"># For Embedding</span>
    <span class="n">rate</span><span class="o">=</span><span class="mf">0.2</span>            <span class="c1"># For Dropout</span>
<span class="p">)</span>
</code></pre></div>

### üè≠ Using the PreprocessorLayerFactory

For more complex scenarios, you can use the `PreprocessorLayerFactory` directly:

<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">kdp.features</span><span class="w"> </span><span class="kn">import</span> <span class="n">TextFeature</span><span class="p">,</span> <span class="n">FeatureType</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">kdp.layers_factory</span><span class="w"> </span><span class="kn">import</span> <span class="n">PreprocessorLayerFactory</span>

<span class="c1"># Create a text feature with custom preprocessing using the factory</span>
<span class="n">text_feature</span> <span class="o">=</span> <span class="n">TextFeature</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;review_text&quot;</span><span class="p">,</span>
    <span class="n">feature_type</span><span class="o">=</span><span class="n">FeatureType</span><span class="o">.</span><span class="n">TEXT</span><span class="p">,</span>
    <span class="n">preprocessors</span><span class="o">=</span><span class="p">[</span>
        <span class="n">PreprocessorLayerFactory</span><span class="o">.</span><span class="n">text_preprocessing_layer</span><span class="p">,</span>
        <span class="s2">&quot;TextVectorization&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Embedding&quot;</span>
    <span class="p">],</span>
    <span class="c1"># Parameters</span>
    <span class="n">stop_words</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;the&quot;</span><span class="p">,</span> <span class="s2">&quot;and&quot;</span><span class="p">,</span> <span class="s2">&quot;is&quot;</span><span class="p">],</span>  <span class="c1"># For TextPreprocessingLayer</span>
    <span class="n">max_tokens</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span>                 <span class="c1"># For TextVectorization</span>
    <span class="n">output_sequence_length</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>        <span class="c1"># For TextVectorization</span>
    <span class="n">output_dim</span><span class="o">=</span><span class="mi">64</span>                     <span class="c1"># For Embedding</span>
<span class="p">)</span>
</code></pre></div>

### üß© Mixing Built-in and Custom Layers

You can combine KDP's specialized layers with standard Keras layers:

<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">kdp.features</span><span class="w"> </span><span class="kn">import</span> <span class="n">NumericalFeature</span><span class="p">,</span> <span class="n">FeatureType</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">kdp.layers_factory</span><span class="w"> </span><span class="kn">import</span> <span class="n">PreprocessorLayerFactory</span>

<span class="c1"># Mix custom and specialized layers</span>
<span class="n">numeric_feature</span> <span class="o">=</span> <span class="n">NumericalFeature</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;transaction_amount&quot;</span><span class="p">,</span>
    <span class="n">feature_type</span><span class="o">=</span><span class="n">FeatureType</span><span class="o">.</span><span class="n">FLOAT</span><span class="p">,</span>
    <span class="n">preprocessors</span><span class="o">=</span><span class="p">[</span>
        <span class="n">PreprocessorLayerFactory</span><span class="o">.</span><span class="n">cast_to_float32_layer</span><span class="p">,</span>
        <span class="s2">&quot;Lambda&quot;</span><span class="p">,</span>
        <span class="n">PreprocessorLayerFactory</span><span class="o">.</span><span class="n">distribution_aware_encoder</span><span class="p">,</span>
        <span class="s2">&quot;Dense&quot;</span>
    <span class="p">],</span>
    <span class="c1"># Parameters</span>
    <span class="n">function</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">clip_by_value</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1000</span><span class="p">),</span>  <span class="c1"># For Lambda</span>
    <span class="n">num_bins</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>                                     <span class="c1"># For DistributionAwareEncoder</span>
    <span class="n">units</span><span class="o">=</span><span class="mi">32</span>                                          <span class="c1"># For Dense</span>
<span class="p">)</span>
</code></pre></div>

### üåü Advanced KDP Layer Examples

KDP provides several specialized preprocessing layers that you can use for advanced feature processing:

#### üíπ Distribution Transformation Layer

<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">kdp.features</span><span class="w"> </span><span class="kn">import</span> <span class="n">NumericalFeature</span><span class="p">,</span> <span class="n">FeatureType</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">kdp.layers_factory</span><span class="w"> </span><span class="kn">import</span> <span class="n">PreprocessorLayerFactory</span>

<span class="c1"># Create a feature that applies distribution transformations</span>
<span class="n">skewed_feature</span> <span class="o">=</span> <span class="n">NumericalFeature</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;highly_skewed_metric&quot;</span><span class="p">,</span>
    <span class="n">feature_type</span><span class="o">=</span><span class="n">FeatureType</span><span class="o">.</span><span class="n">FLOAT</span><span class="p">,</span>
    <span class="n">preprocessors</span><span class="o">=</span><span class="p">[</span>
        <span class="n">PreprocessorLayerFactory</span><span class="o">.</span><span class="n">cast_to_float32_layer</span><span class="p">,</span>
        <span class="n">PreprocessorLayerFactory</span><span class="o">.</span><span class="n">distribution_transform_layer</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="c1"># Parameters for DistributionTransformLayer</span>
    <span class="n">transform_type</span><span class="o">=</span><span class="s2">&quot;box-cox&quot;</span><span class="p">,</span>  <span class="c1"># Apply Box-Cox transformation</span>
    <span class="n">lambda_param</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>         <span class="c1"># Parameter for Box-Cox</span>
    <span class="n">epsilon</span><span class="o">=</span><span class="mf">1e-6</span>              <span class="c1"># Prevent numerical issues</span>
<span class="p">)</span>

<span class="c1"># Automatic transformation selection</span>
<span class="n">auto_transform_feature</span> <span class="o">=</span> <span class="n">NumericalFeature</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;unknown_distribution&quot;</span><span class="p">,</span>
    <span class="n">feature_type</span><span class="o">=</span><span class="n">FeatureType</span><span class="o">.</span><span class="n">FLOAT</span><span class="p">,</span>
    <span class="n">preprocessors</span><span class="o">=</span><span class="p">[</span>
        <span class="n">PreprocessorLayerFactory</span><span class="o">.</span><span class="n">cast_to_float32_layer</span><span class="p">,</span>
        <span class="n">PreprocessorLayerFactory</span><span class="o">.</span><span class="n">distribution_transform_layer</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="c1"># Let the layer choose the best transformation</span>
    <span class="n">transform_type</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span><span class="p">,</span>
    <span class="n">auto_candidates</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;log&quot;</span><span class="p">,</span> <span class="s2">&quot;sqrt&quot;</span><span class="p">,</span> <span class="s2">&quot;box-cox&quot;</span><span class="p">,</span> <span class="s2">&quot;yeo-johnson&quot;</span><span class="p">]</span>
<span class="p">)</span>
</code></pre></div>

#### üßÆ Numerical Embeddings

<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">kdp.features</span><span class="w"> </span><span class="kn">import</span> <span class="n">NumericalFeature</span><span class="p">,</span> <span class="n">FeatureType</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">kdp.layers_factory</span><span class="w"> </span><span class="kn">import</span> <span class="n">PreprocessorLayerFactory</span>

<span class="c1"># Create a feature with numerical embedding</span>
<span class="n">embedded_numeric</span> <span class="o">=</span> <span class="n">NumericalFeature</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;user_age&quot;</span><span class="p">,</span>
    <span class="n">feature_type</span><span class="o">=</span><span class="n">FeatureType</span><span class="o">.</span><span class="n">FLOAT</span><span class="p">,</span>
    <span class="n">preprocessors</span><span class="o">=</span><span class="p">[</span>
        <span class="n">PreprocessorLayerFactory</span><span class="o">.</span><span class="n">cast_to_float32_layer</span><span class="p">,</span>
        <span class="n">PreprocessorLayerFactory</span><span class="o">.</span><span class="n">numerical_embedding_layer</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="c1"># Parameters for NumericalEmbedding</span>
    <span class="n">embedding_dim</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span>       <span class="c1"># Output dimension</span>
    <span class="n">mlp_hidden_units</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span>    <span class="c1"># MLP hidden units</span>
    <span class="n">num_bins</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>            <span class="c1"># Number of bins for discretization</span>
    <span class="n">init_min</span><span class="o">=</span><span class="mi">18</span><span class="p">,</span>            <span class="c1"># Minimum value for initialization</span>
    <span class="n">init_max</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>           <span class="c1"># Maximum value for initialization</span>
    <span class="n">dropout_rate</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span>       <span class="c1"># Dropout rate</span>
    <span class="n">use_batch_norm</span><span class="o">=</span><span class="kc">True</span>     <span class="c1"># Apply batch normalization</span>
<span class="p">)</span>
</code></pre></div>

#### üåê Global Numerical Embedding

<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">kdp.features</span><span class="w"> </span><span class="kn">import</span> <span class="n">NumericalFeature</span><span class="p">,</span> <span class="n">FeatureType</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">kdp.layers_factory</span><span class="w"> </span><span class="kn">import</span> <span class="n">PreprocessorLayerFactory</span>

<span class="c1"># Process multiple numeric features as a group with global pooling</span>
<span class="n">global_numerics</span> <span class="o">=</span> <span class="n">NumericalFeature</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;numeric_group&quot;</span><span class="p">,</span>
    <span class="n">feature_type</span><span class="o">=</span><span class="n">FeatureType</span><span class="o">.</span><span class="n">FLOAT</span><span class="p">,</span>
    <span class="n">preprocessors</span><span class="o">=</span><span class="p">[</span>
        <span class="n">PreprocessorLayerFactory</span><span class="o">.</span><span class="n">cast_to_float32_layer</span><span class="p">,</span>
        <span class="n">PreprocessorLayerFactory</span><span class="o">.</span><span class="n">global_numerical_embedding_layer</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="c1"># Parameters for GlobalNumericalEmbedding</span>
    <span class="n">global_embedding_dim</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span>        <span class="c1"># Final embedding dimension</span>
    <span class="n">global_mlp_hidden_units</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span>     <span class="c1"># MLP hidden units</span>
    <span class="n">global_num_bins</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span>             <span class="c1"># Number of bins</span>
    <span class="n">global_dropout_rate</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>        <span class="c1"># Dropout rate</span>
    <span class="n">global_use_batch_norm</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>     <span class="c1"># Apply batch normalization</span>
    <span class="n">global_pooling</span><span class="o">=</span><span class="s2">&quot;average&quot;</span>        <span class="c1"># Pooling method (&quot;average&quot; or &quot;max&quot;)</span>
<span class="p">)</span>
</code></pre></div>

#### üîÄ Gated Linear Unit

<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">kdp.features</span><span class="w"> </span><span class="kn">import</span> <span class="n">NumericalFeature</span><span class="p">,</span> <span class="n">FeatureType</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">kdp.layers_factory</span><span class="w"> </span><span class="kn">import</span> <span class="n">PreprocessorLayerFactory</span>

<span class="c1"># Apply a gated linear unit to a feature</span>
<span class="n">gated_feature</span> <span class="o">=</span> <span class="n">NumericalFeature</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;sales_volume&quot;</span><span class="p">,</span>
    <span class="n">feature_type</span><span class="o">=</span><span class="n">FeatureType</span><span class="o">.</span><span class="n">FLOAT</span><span class="p">,</span>
    <span class="n">preprocessors</span><span class="o">=</span><span class="p">[</span>
        <span class="n">PreprocessorLayerFactory</span><span class="o">.</span><span class="n">cast_to_float32_layer</span><span class="p">,</span>
        <span class="s2">&quot;Normalization&quot;</span><span class="p">,</span>
        <span class="n">PreprocessorLayerFactory</span><span class="o">.</span><span class="n">gated_linear_unit_layer</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="c1"># Parameters for GatedLinearUnit</span>
    <span class="n">units</span><span class="o">=</span><span class="mi">32</span>  <span class="c1"># Output dimension</span>
<span class="p">)</span>
</code></pre></div>

#### üîÑ Gated Residual Network

<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">kdp.features</span><span class="w"> </span><span class="kn">import</span> <span class="n">NumericalFeature</span><span class="p">,</span> <span class="n">FeatureType</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">kdp.layers_factory</span><span class="w"> </span><span class="kn">import</span> <span class="n">PreprocessorLayerFactory</span>

<span class="c1"># Apply a gated residual network to a feature</span>
<span class="n">grn_feature</span> <span class="o">=</span> <span class="n">NumericalFeature</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;complex_metric&quot;</span><span class="p">,</span>
    <span class="n">feature_type</span><span class="o">=</span><span class="n">FeatureType</span><span class="o">.</span><span class="n">FLOAT</span><span class="p">,</span>
    <span class="n">preprocessors</span><span class="o">=</span><span class="p">[</span>
        <span class="n">PreprocessorLayerFactory</span><span class="o">.</span><span class="n">cast_to_float32_layer</span><span class="p">,</span>
        <span class="n">PreprocessorLayerFactory</span><span class="o">.</span><span class="n">gated_residual_network_layer</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="c1"># Parameters for GatedResidualNetwork</span>
    <span class="n">units</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span>            <span class="c1"># Output dimension</span>
    <span class="n">dropout_rate</span><span class="o">=</span><span class="mf">0.3</span>     <span class="c1"># Dropout rate</span>
<span class="p">)</span>
</code></pre></div>

### ‚ûï Adding Preprocessors Dynamically

You can also add preprocessors dynamically after feature creation:

<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">kdp.features</span><span class="w"> </span><span class="kn">import</span> <span class="n">NumericalFeature</span><span class="p">,</span> <span class="n">FeatureType</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">tensorflow.keras.layers</span><span class="w"> </span><span class="kn">import</span> <span class="n">Dense</span>

<span class="c1"># Create a feature</span>
<span class="n">feature</span> <span class="o">=</span> <span class="n">NumericalFeature</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;age&quot;</span><span class="p">,</span>
    <span class="n">feature_type</span><span class="o">=</span><span class="n">FeatureType</span><span class="o">.</span><span class="n">FLOAT_NORMALIZED</span>
<span class="p">)</span>

<span class="c1"># Add preprocessors later</span>
<span class="n">feature</span><span class="o">.</span><span class="n">add_preprocessor</span><span class="p">(</span><span class="s2">&quot;Normalization&quot;</span><span class="p">)</span>
<span class="n">feature</span><span class="o">.</span><span class="n">add_preprocessor</span><span class="p">(</span><span class="n">Dense</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s2">&quot;relu&quot;</span><span class="p">)</span>
<span class="n">feature</span><span class="o">.</span><span class="n">add_preprocessor</span><span class="p">(</span><span class="n">PreprocessorLayerFactory</span><span class="o">.</span><span class="n">distribution_aware_encoder</span><span class="p">,</span> <span class="n">num_bins</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
</code></pre></div>

## üöÑ DynamicPreprocessingPipeline

For even more flexibility and direct control over your preprocessing workflow, KDP offers the `DynamicPreprocessingPipeline`. This powerful tool allows you to create custom preprocessing pipelines with explicit dependency tracking between layers and seamless integration with TensorFlow's data pipelines.

### ‚ú® Key Benefits

- üîÑ **Layer Dependencies**: Automatically tracks dependencies between layers
- üéØ **Selective Computation**: Only computes what's needed based on dependencies
- üíæ **Memory Efficiency**: Doesn't keep unnecessary intermediate tensors
- üîå **TF Data Integration**: Works directly with `tf.data.Dataset` objects
- üõ†Ô∏è **Customizability**: Use any Keras layer in your preprocessing pipeline
- üìù **Simplicity**: Cleaner approach for complex preprocessing compared to feature-based methods

### üèÅ Basic Usage

<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">tensorflow</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">tf</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">kdp.dynamic_pipeline</span><span class="w"> </span><span class="kn">import</span> <span class="n">DynamicPreprocessingPipeline</span>

<span class="c1"># Create custom layers</span>
<span class="k">class</span><span class="w"> </span><span class="nc">ScalingLayer</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Layer</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">scaling_factor</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scaling_factor</span> <span class="o">=</span> <span class="n">scaling_factor</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">call</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">inputs</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">scaling_factor</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_config</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">config</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">get_config</span><span class="p">()</span>
        <span class="n">config</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;scaling_factor&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">scaling_factor</span><span class="p">})</span>
        <span class="k">return</span> <span class="n">config</span>

<span class="k">class</span><span class="w"> </span><span class="nc">NormalizationLayer</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Layer</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">call</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="p">):</span>
        <span class="n">mean</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">reduce_mean</span><span class="p">(</span><span class="n">inputs</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">std</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">math</span><span class="o">.</span><span class="n">reduce_std</span><span class="p">(</span><span class="n">inputs</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">inputs</span> <span class="o">-</span> <span class="n">mean</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">std</span> <span class="o">+</span> <span class="mf">1e-5</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_config</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">get_config</span><span class="p">()</span>

<span class="c1"># Create the pipeline with custom layers</span>
<span class="n">scaling_layer</span> <span class="o">=</span> <span class="n">ScalingLayer</span><span class="p">(</span><span class="n">scaling_factor</span><span class="o">=</span><span class="mf">3.0</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;scaling&#39;</span><span class="p">)</span>
<span class="n">normalization_layer</span> <span class="o">=</span> <span class="n">NormalizationLayer</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;normalization&#39;</span><span class="p">)</span>
<span class="n">pipeline</span> <span class="o">=</span> <span class="n">DynamicPreprocessingPipeline</span><span class="p">([</span><span class="n">scaling_layer</span><span class="p">,</span> <span class="n">normalization_layer</span><span class="p">])</span>

<span class="c1"># Create sample data with keys matching layer names</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">1.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">2.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">3.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">4.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">5.0</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="n">dataset</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">Dataset</span><span class="o">.</span><span class="n">from_tensor_slices</span><span class="p">({</span>
    <span class="s1">&#39;scaling&#39;</span><span class="p">:</span> <span class="n">data</span><span class="p">,</span>
    <span class="s1">&#39;normalization&#39;</span><span class="p">:</span> <span class="n">data</span>
<span class="p">})</span>

<span class="c1"># Process the data</span>
<span class="n">processed_dataset</span> <span class="o">=</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span>

<span class="c1"># Use the processed data</span>
<span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">processed_dataset</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Scaled data:&quot;</span><span class="p">,</span> <span class="n">element</span><span class="p">[</span><span class="s1">&#39;scaling&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">numpy</span><span class="p">())</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Normalized data:&quot;</span><span class="p">,</span> <span class="n">element</span><span class="p">[</span><span class="s1">&#39;normalization&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">numpy</span><span class="p">())</span>
</code></pre></div>

### üîó Pipeline with Dependencies

The real power of `DynamicPreprocessingPipeline` comes from its ability to automatically handle dependencies between layers:

<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">tensorflow</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">tf</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">kdp.dynamic_pipeline</span><span class="w"> </span><span class="kn">import</span> <span class="n">DynamicPreprocessingPipeline</span>

<span class="c1"># Create a pipeline with a sequence of layers</span>
<span class="n">scaling_layer</span> <span class="o">=</span> <span class="n">ScalingLayer</span><span class="p">(</span><span class="n">scaling_factor</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;scaling&#39;</span><span class="p">)</span>
<span class="n">log_layer</span> <span class="o">=</span> <span class="n">LogTransformLayer</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;log_transform&#39;</span><span class="p">)</span>
<span class="n">norm_layer</span> <span class="o">=</span> <span class="n">NormalizationLayer</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;normalization&#39;</span><span class="p">)</span>

<span class="c1"># Create pipeline with dependency order - each layer processes the output of the previous</span>
<span class="n">pipeline</span> <span class="o">=</span> <span class="n">DynamicPreprocessingPipeline</span><span class="p">([</span><span class="n">scaling_layer</span><span class="p">,</span> <span class="n">log_layer</span><span class="p">,</span> <span class="n">norm_layer</span><span class="p">])</span>

<span class="c1"># Only need to provide the initial input - the rest is handled automatically</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">1.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">5.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">10.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">50.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">100.0</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="n">dataset</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">Dataset</span><span class="o">.</span><span class="n">from_tensor_slices</span><span class="p">({</span>
    <span class="s1">&#39;scaling&#39;</span><span class="p">:</span> <span class="n">data</span><span class="p">,</span>  <span class="c1"># Only provide the input for the first layer</span>
<span class="p">})</span>

<span class="c1"># Process the data</span>
<span class="n">processed_dataset</span> <span class="o">=</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span>

<span class="c1"># Access all intermediate and final outputs</span>
<span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">processed_dataset</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Scaled data:&quot;</span><span class="p">,</span> <span class="n">element</span><span class="p">[</span><span class="s1">&#39;scaling&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">numpy</span><span class="p">())</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Log-transformed data:&quot;</span><span class="p">,</span> <span class="n">element</span><span class="p">[</span><span class="s1">&#39;log_transform&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">numpy</span><span class="p">())</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Normalized data:&quot;</span><span class="p">,</span> <span class="n">element</span><span class="p">[</span><span class="s1">&#39;normalization&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">numpy</span><span class="p">())</span>
</code></pre></div>

### üß© Processing Multiple Feature Types

You can create separate pipelines for different feature types:

<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">tensorflow</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">tf</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">kdp.dynamic_pipeline</span><span class="w"> </span><span class="kn">import</span> <span class="n">DynamicPreprocessingPipeline</span>

<span class="c1"># Custom encoding layer for categorical features</span>
<span class="k">class</span><span class="w"> </span><span class="nc">EncodingLayer</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Layer</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vocabulary</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vocabulary</span> <span class="o">=</span> <span class="n">vocabulary</span> <span class="ow">or</span> <span class="p">[]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">build</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_shape</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lookup_table</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">StringLookup</span><span class="p">(</span>
            <span class="n">vocabulary</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">vocabulary</span><span class="p">,</span>
            <span class="n">mask_token</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">num_oov_indices</span><span class="o">=</span><span class="mi">1</span>
        <span class="p">)</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="n">input_shape</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">call</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="p">):</span>
        <span class="n">indices</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lookup_table</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">tf</span><span class="o">.</span><span class="n">one_hot</span><span class="p">(</span><span class="n">indices</span><span class="p">,</span> <span class="n">depth</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vocabulary</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>

<span class="c1"># Create pipelines for different feature types</span>
<span class="n">numeric_scaling</span> <span class="o">=</span> <span class="n">ScalingLayer</span><span class="p">(</span><span class="n">scaling_factor</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;numeric_scaling&#39;</span><span class="p">)</span>
<span class="n">numeric_pipeline</span> <span class="o">=</span> <span class="n">DynamicPreprocessingPipeline</span><span class="p">([</span><span class="n">numeric_scaling</span><span class="p">])</span>

<span class="n">categorical_encoding</span> <span class="o">=</span> <span class="n">EncodingLayer</span><span class="p">(</span>
    <span class="n">vocabulary</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">],</span>
    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;categorical_encoding&#39;</span>
<span class="p">)</span>
<span class="n">categorical_pipeline</span> <span class="o">=</span> <span class="n">DynamicPreprocessingPipeline</span><span class="p">([</span><span class="n">categorical_encoding</span><span class="p">])</span>

<span class="c1"># Process different types of data</span>
<span class="n">numeric_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">1.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">2.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">3.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">4.0</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="n">categorical_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="s1">&#39;A&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;B&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;D&#39;</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">object_</span><span class="p">)</span>

<span class="n">numeric_dataset</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">Dataset</span><span class="o">.</span><span class="n">from_tensor_slices</span><span class="p">({</span>
    <span class="s1">&#39;numeric_scaling&#39;</span><span class="p">:</span> <span class="n">numeric_data</span>
<span class="p">})</span>

<span class="n">categorical_dataset</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">Dataset</span><span class="o">.</span><span class="n">from_tensor_slices</span><span class="p">({</span>
    <span class="s1">&#39;categorical_encoding&#39;</span><span class="p">:</span> <span class="n">categorical_data</span>
<span class="p">})</span>

<span class="c1"># Process each dataset</span>
<span class="n">processed_numeric</span> <span class="o">=</span> <span class="n">numeric_pipeline</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="n">numeric_dataset</span><span class="p">)</span>
<span class="n">processed_categorical</span> <span class="o">=</span> <span class="n">categorical_pipeline</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="n">categorical_dataset</span><span class="p">)</span>
</code></pre></div>

### üîÑ Integration with Keras Models

The `DynamicPreprocessingPipeline` can be easily integrated with Keras models:

<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">tensorflow</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">tf</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">kdp.dynamic_pipeline</span><span class="w"> </span><span class="kn">import</span> <span class="n">DynamicPreprocessingPipeline</span>

<span class="c1"># Create preprocessing pipeline</span>
<span class="n">scaling_layer</span> <span class="o">=</span> <span class="n">ScalingLayer</span><span class="p">(</span><span class="n">scaling_factor</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;scaling&#39;</span><span class="p">)</span>
<span class="n">normalization_layer</span> <span class="o">=</span> <span class="n">NormalizationLayer</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;normalization&#39;</span><span class="p">)</span>
<span class="n">preprocess_pipeline</span> <span class="o">=</span> <span class="n">DynamicPreprocessingPipeline</span><span class="p">([</span><span class="n">scaling_layer</span><span class="p">,</span> <span class="n">normalization_layer</span><span class="p">])</span>

<span class="c1"># Create a simple Keras model</span>
<span class="n">inputs</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">Input</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;model_input&#39;</span><span class="p">)</span>
<span class="n">dense1</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">)(</span><span class="n">inputs</span><span class="p">)</span>
<span class="n">outputs</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">1</span><span class="p">)(</span><span class="n">dense1</span><span class="p">)</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">Model</span><span class="p">(</span><span class="n">inputs</span><span class="o">=</span><span class="n">inputs</span><span class="p">,</span> <span class="n">outputs</span><span class="o">=</span><span class="n">outputs</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">optimizer</span><span class="o">=</span><span class="s1">&#39;adam&#39;</span><span class="p">,</span> <span class="n">loss</span><span class="o">=</span><span class="s1">&#39;mse&#39;</span><span class="p">)</span>

<span class="c1"># Prepare data</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">1.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">2.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">3.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">4.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">5.0</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="n">targets</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">2.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">4.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">6.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">8.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">10.0</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>

<span class="c1"># Create dataset and preprocess</span>
<span class="n">dataset</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">Dataset</span><span class="o">.</span><span class="n">from_tensor_slices</span><span class="p">({</span>
    <span class="s1">&#39;scaling&#39;</span><span class="p">:</span> <span class="n">data</span><span class="p">,</span>
    <span class="s1">&#39;normalization&#39;</span><span class="p">:</span> <span class="n">data</span><span class="p">,</span>
    <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="n">targets</span>
<span class="p">})</span><span class="o">.</span><span class="n">batch</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

<span class="n">processed_dataset</span> <span class="o">=</span> <span class="n">preprocess_pipeline</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span>

<span class="c1"># Create training data generator</span>
<span class="k">def</span><span class="w"> </span><span class="nf">data_generator</span><span class="p">():</span>
    <span class="k">for</span> <span class="n">batch</span> <span class="ow">in</span> <span class="n">processed_dataset</span><span class="p">:</span>
        <span class="c1"># Use the normalized data as model input</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">batch</span><span class="p">[</span><span class="s1">&#39;normalization&#39;</span><span class="p">]</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">batch</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span>
        <span class="k">yield</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span>

<span class="c1"># Create a dataset from the generator and train the model</span>
<span class="n">train_dataset</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">Dataset</span><span class="o">.</span><span class="n">from_generator</span><span class="p">(</span>
    <span class="n">data_generator</span><span class="p">,</span>
    <span class="n">output_signature</span><span class="o">=</span><span class="p">(</span>
        <span class="n">tf</span><span class="o">.</span><span class="n">TensorSpec</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">float32</span><span class="p">),</span>
        <span class="n">tf</span><span class="o">.</span><span class="n">TensorSpec</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
    <span class="p">)</span>
<span class="p">)</span>

<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_dataset</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</code></pre></div>

## üõ†Ô∏è Creating Custom Preprocessing Layers

For even more flexibility, you can create your own custom preprocessing layer:

<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">tensorflow</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">tf</span>

<span class="k">class</span><span class="w"> </span><span class="nc">CustomScalingLayer</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Layer</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">scaling_factor</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scaling_factor</span> <span class="o">=</span> <span class="n">scaling_factor</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">call</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">inputs</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">scaling_factor</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_config</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">config</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">get_config</span><span class="p">()</span>
        <span class="n">config</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;scaling_factor&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">scaling_factor</span><span class="p">})</span>
        <span class="k">return</span> <span class="n">config</span>

<span class="c1"># Use your custom layer in a feature</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">kdp.features</span><span class="w"> </span><span class="kn">import</span> <span class="n">NumericalFeature</span><span class="p">,</span> <span class="n">FeatureType</span>

<span class="n">feature</span> <span class="o">=</span> <span class="n">NumericalFeature</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;custom_scaled&quot;</span><span class="p">,</span>
    <span class="n">feature_type</span><span class="o">=</span><span class="n">FeatureType</span><span class="o">.</span><span class="n">FLOAT</span><span class="p">,</span>
    <span class="n">preprocessors</span><span class="o">=</span><span class="p">[</span>
        <span class="n">CustomScalingLayer</span><span class="p">,</span>
        <span class="s2">&quot;Dense&quot;</span>
    <span class="p">],</span>
    <span class="n">scaling_factor</span><span class="o">=</span><span class="mf">5.0</span><span class="p">,</span>  <span class="c1"># For CustomScalingLayer</span>
    <span class="n">units</span><span class="o">=</span><span class="mi">16</span>             <span class="c1"># For Dense</span>
<span class="p">)</span>
</code></pre></div>

## ü§î When to Use DynamicPreprocessingPipeline vs. PreprocessingModel

Both approaches have their strengths:

| üöÑ **Use DynamicPreprocessingPipeline when:** | üì¶ **Use PreprocessingModel when:** |
|---|---|
| üîç You need fine-grained control over the preprocessing flow | üîÑ You want the full KDP feature mapping system |
| üîó You want explicit dependency tracking between layers | üß© You need integration with other KDP features (feature selection, etc.) |
| üìä You're working with `tf.data.Dataset` and want efficient streaming | üìù You prefer a declarative approach with feature specifications |
| üß™ You prefer a more procedural approach to preprocessing | üíæ You want to save the entire preprocessing model as one unit |
| ‚ö° You want to avoid the overhead of the feature-based system | |

## üìã Complete Example with DynamicPreprocessingPipeline

Here's a comprehensive example showing how to use `DynamicPreprocessingPipeline` with various custom layer types:

<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">tensorflow</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">tf</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">kdp.dynamic_pipeline</span><span class="w"> </span><span class="kn">import</span> <span class="n">DynamicPreprocessingPipeline</span>

<span class="c1"># Define custom layers</span>
<span class="k">class</span><span class="w"> </span><span class="nc">ScalingLayer</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Layer</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">scaling_factor</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scaling_factor</span> <span class="o">=</span> <span class="n">scaling_factor</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">call</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">inputs</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">scaling_factor</span>

<span class="k">class</span><span class="w"> </span><span class="nc">LogTransformLayer</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Layer</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">=</span> <span class="n">offset</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">call</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">tf</span><span class="o">.</span><span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">inputs</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">)</span>

<span class="k">class</span><span class="w"> </span><span class="nc">NormalizationLayer</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Layer</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">call</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="p">):</span>
        <span class="n">mean</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">reduce_mean</span><span class="p">(</span><span class="n">inputs</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">std</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">math</span><span class="o">.</span><span class="n">reduce_std</span><span class="p">(</span><span class="n">inputs</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">inputs</span> <span class="o">-</span> <span class="n">mean</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">std</span> <span class="o">+</span> <span class="mf">1e-5</span><span class="p">)</span>

<span class="k">class</span><span class="w"> </span><span class="nc">EncodingLayer</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Layer</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vocabulary</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vocabulary</span> <span class="o">=</span> <span class="n">vocabulary</span> <span class="ow">or</span> <span class="p">[]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">build</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_shape</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lookup_table</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">StringLookup</span><span class="p">(</span>
            <span class="n">vocabulary</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">vocabulary</span><span class="p">,</span>
            <span class="n">mask_token</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">num_oov_indices</span><span class="o">=</span><span class="mi">1</span>
        <span class="p">)</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="n">input_shape</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">call</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="p">):</span>
        <span class="n">indices</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lookup_table</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">tf</span><span class="o">.</span><span class="n">one_hot</span><span class="p">(</span><span class="n">indices</span><span class="p">,</span> <span class="n">depth</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vocabulary</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>

<span class="c1"># Create a multi-step pipeline</span>
<span class="n">scaling</span> <span class="o">=</span> <span class="n">ScalingLayer</span><span class="p">(</span><span class="n">scaling_factor</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;scaling&#39;</span><span class="p">)</span>
<span class="n">log_transform</span> <span class="o">=</span> <span class="n">LogTransformLayer</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;log_transform&#39;</span><span class="p">)</span>
<span class="n">normalization</span> <span class="o">=</span> <span class="n">NormalizationLayer</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;normalization&#39;</span><span class="p">)</span>
<span class="n">pipeline</span> <span class="o">=</span> <span class="n">DynamicPreprocessingPipeline</span><span class="p">([</span><span class="n">scaling</span><span class="p">,</span> <span class="n">log_transform</span><span class="p">,</span> <span class="n">normalization</span><span class="p">])</span>

<span class="c1"># Create sample data</span>
<span class="n">numeric_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">1.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">5.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">10.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">50.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">100.0</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="n">dataset</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">Dataset</span><span class="o">.</span><span class="n">from_tensor_slices</span><span class="p">({</span>
    <span class="s1">&#39;scaling&#39;</span><span class="p">:</span> <span class="n">numeric_data</span>  <span class="c1"># Initial input</span>
<span class="p">})</span><span class="o">.</span><span class="n">batch</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># Process the data</span>
<span class="n">processed_dataset</span> <span class="o">=</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span>

<span class="c1"># Create a model</span>
<span class="n">inputs</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">Input</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,))</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">)(</span><span class="n">inputs</span><span class="p">)</span>
<span class="n">outputs</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">1</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">Model</span><span class="p">(</span><span class="n">inputs</span><span class="o">=</span><span class="n">inputs</span><span class="p">,</span> <span class="n">outputs</span><span class="o">=</span><span class="n">outputs</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">optimizer</span><span class="o">=</span><span class="s1">&#39;adam&#39;</span><span class="p">,</span> <span class="n">loss</span><span class="o">=</span><span class="s1">&#39;mse&#39;</span><span class="p">)</span>

<span class="c1"># Use the preprocessed data for training</span>
<span class="k">def</span><span class="w"> </span><span class="nf">data_generator</span><span class="p">():</span>
    <span class="k">for</span> <span class="n">batch</span> <span class="ow">in</span> <span class="n">processed_dataset</span><span class="p">:</span>
        <span class="c1"># Use the fully processed data</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">batch</span><span class="p">[</span><span class="s1">&#39;normalization&#39;</span><span class="p">]</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">x</span> <span class="o">*</span> <span class="mi">2</span>  <span class="c1"># Synthetic targets</span>
        <span class="k">yield</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span>

<span class="n">train_dataset</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">Dataset</span><span class="o">.</span><span class="n">from_generator</span><span class="p">(</span>
    <span class="n">data_generator</span><span class="p">,</span>
    <span class="n">output_signature</span><span class="o">=</span><span class="p">(</span>
        <span class="n">tf</span><span class="o">.</span><span class="n">TensorSpec</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">float32</span><span class="p">),</span>
        <span class="n">tf</span><span class="o">.</span><span class="n">TensorSpec</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
    <span class="p">)</span>
<span class="p">)</span>

<span class="c1"># Train the model</span>
<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_dataset</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</code></pre></div>

## üìù Summary

KDP offers multiple approaches to custom preprocessing, from simple layer addition to sophisticated dynamic pipelines. The `DynamicPreprocessingPipeline` provides a powerful and flexible way to create custom preprocessing workflows with explicit dependency tracking, while the feature-based approach with `PreprocessingModel` offers integration with KDP's broader feature handling ecosystem. Choose the approach that best fits your specific needs and workflow preferences.

## üí° Best Practices

1. üèÅ **Start Simple**: Begin with the simplest preprocessing pipeline that meets your needs
2. üß™ **Test Incrementally**: Add preprocessing steps one at a time and test their impact
3. ‚ö° **Consider Performance**: Complex preprocessing can impact training and inference speed
4. üíæ **Monitor Memory Usage**: Custom preprocessing can increase memory requirements
5. üìù **Document Your Approach**: Document why custom preprocessing was necessary
6. üîÅ **Ensure Reproducibility**: Make sure custom preprocessing is deterministic

## ü§ñ Auto-Configuration Script

KDP provides an auto-configuration script that analyzes your dataset and recommends optimal preprocessing configurations. This tool can help you get started quickly by automatically detecting feature types and suggesting appropriate preprocessing steps.

### üöÄ Basic Usage

<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">kdp</span><span class="w"> </span><span class="kn">import</span> <span class="n">auto_configure</span>

<span class="c1"># Analyze your dataset and get recommendations</span>
<span class="n">config</span> <span class="o">=</span> <span class="n">auto_configure</span><span class="p">(</span>
    <span class="n">data_path</span><span class="o">=</span><span class="s2">&quot;your_data.csv&quot;</span><span class="p">,</span>
    <span class="n">batch_size</span><span class="o">=</span><span class="mi">50000</span><span class="p">,</span>
    <span class="n">save_stats</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>

<span class="c1"># Review the recommendations</span>
<span class="nb">print</span><span class="p">(</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;recommendations&quot;</span><span class="p">])</span>  <span class="c1"># Feature-specific recommendations</span>
<span class="nb">print</span><span class="p">(</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;code_snippet&quot;</span><span class="p">])</span>     <span class="c1"># Ready-to-use code</span>
</code></pre></div>

### üìä What It Analyzes

The auto-configuration script examines:

- üîç **Data Distributions**: Identifies patterns in numerical data
- üìà **Feature Statistics**: Calculates mean, variance, skewness, etc.
- üéØ **Value Ranges**: Detects min/max values and outliers
- üîÑ **Value Patterns**: Distinguishes between discrete and continuous values

### üõ†Ô∏è Command Line Interface

You can also use the script from the command line:

<div class="highlight"><pre><span></span><code>python<span class="w"> </span>-m<span class="w"> </span>kdp.scripts.analyze_dataset<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--data<span class="w"> </span>your_data.csv<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--output<span class="w"> </span>recommendations.json<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--stats<span class="w"> </span>features_stats.json<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--batch-size<span class="w"> </span><span class="m">50000</span>
</code></pre></div>

### üìù Example Output

The script generates a comprehensive report including:

<div class="highlight"><pre><span></span><code><span class="p">{</span>
    <span class="s2">&quot;recommendations&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;income&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;feature_type&quot;</span><span class="p">:</span> <span class="s2">&quot;NumericalFeature&quot;</span><span class="p">,</span>
            <span class="s2">&quot;preprocessing&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;NORMALIZATION&quot;</span><span class="p">],</span>
            <span class="s2">&quot;detected_distribution&quot;</span><span class="p">:</span> <span class="s2">&quot;log_normal&quot;</span><span class="p">,</span>
            <span class="s2">&quot;config&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;embedding_dim&quot;</span><span class="p">:</span> <span class="mi">16</span><span class="p">,</span>
                <span class="s2">&quot;num_bins&quot;</span><span class="p">:</span> <span class="mi">20</span>
            <span class="p">}</span>
        <span class="p">},</span>
        <span class="s2">&quot;age&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;feature_type&quot;</span><span class="p">:</span> <span class="s2">&quot;NumericalFeature&quot;</span><span class="p">,</span>
            <span class="s2">&quot;preprocessing&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;NORMALIZATION&quot;</span><span class="p">],</span>
            <span class="s2">&quot;detected_distribution&quot;</span><span class="p">:</span> <span class="s2">&quot;normal&quot;</span><span class="p">,</span>
            <span class="s2">&quot;config&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;embedding_dim&quot;</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span>
                <span class="s2">&quot;num_bins&quot;</span><span class="p">:</span> <span class="mi">10</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">},</span>
    <span class="s2">&quot;code_snippet&quot;</span><span class="p">:</span> <span class="s2">&quot;# Generated code implementing the recommendations&quot;</span><span class="p">,</span>
    <span class="s2">&quot;statistics&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="c1"># Detailed feature statistics</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

### üí° Pro Tips for Auto-Configuration

1. **Review Before Implementing**: Always review the recommendations before applying them
2. **Combine with Domain Knowledge**: Use the recommendations alongside your expertise
3. **Update When Data Changes**: Rerun the analysis when your data distribution changes
4. **Customize as Needed**: Modify the generated code to match your specific requirements

## ‚ö†Ô∏è Limitations and Considerations

- üíæ Custom preprocessing layers must be compatible with TensorFlow's serialization
- üîÑ All layers must implement `get_config()` and `from_config()` for proper saving/loading
- ‚è±Ô∏è Complex custom preprocessing may impact performance
- üöÄ Consider using `tf.function` for performance-critical custom operations
- üß™ Ensure custom preprocessing works in both eager and graph execution modes

## üîç Advanced Topics

### üîÑ Handling Stateful Preprocessing

For preprocessing that requires state (like normalization), ensure proper initialization:

<div class="highlight"><pre><span></span><code><span class="c1"># Stateful preprocessing example</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">kdp.features</span><span class="w"> </span><span class="kn">import</span> <span class="n">NumericalFeature</span><span class="p">,</span> <span class="n">FeatureType</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">tensorflow</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">tf</span>

<span class="n">feature</span> <span class="o">=</span> <span class="n">NumericalFeature</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;height&quot;</span><span class="p">,</span>
    <span class="n">feature_type</span><span class="o">=</span><span class="n">FeatureType</span><span class="o">.</span><span class="n">FLOAT</span><span class="p">,</span>
    <span class="n">preprocessors</span><span class="o">=</span><span class="p">[</span>
        <span class="s2">&quot;Normalization&quot;</span>
    <span class="p">]</span>
<span class="p">)</span>

<span class="c1"># The normalization layer needs to be adapted to the data</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">PreprocessingModel</span><span class="p">(</span><span class="n">features</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;height&quot;</span><span class="p">:</span> <span class="n">feature</span><span class="p">})</span>
<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>  <span class="c1"># This initializes the normalization statistics</span>
</code></pre></div>

### üöÄ GPU-Accelerated Custom Preprocessing

Ensure your custom layers leverage GPU acceleration when available:

<div class="highlight"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">GPUAwareCustomLayer</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Layer</span><span class="p">):</span>
    <span class="nd">@tf</span><span class="o">.</span><span class="n">function</span>  <span class="c1"># Enable graph execution for better GPU performance</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">call</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="p">):</span>
        <span class="c1"># Use TensorFlow operations that support GPU execution</span>
        <span class="k">return</span> <span class="n">tf</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span> <span class="o">*</span> <span class="n">tf</span><span class="o">.</span><span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">inputs</span><span class="p">))</span>
</code></pre></div>

### üêû Debugging Custom Preprocessing

To debug custom preprocessing pipelines:

<div class="highlight"><pre><span></span><code><span class="c1"># Enable debug logging</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">logging</span>
<span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">DEBUG</span><span class="p">)</span>

<span class="c1"># Create a model with your custom preprocessing</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">PreprocessingModel</span><span class="p">(</span><span class="n">features</span><span class="o">=</span><span class="n">features</span><span class="p">)</span>

<span class="c1"># Inspect the model layers</span>
<span class="n">model</span><span class="o">.</span><span class="n">build_model</span><span class="p">()</span>
<span class="n">model</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>

<span class="c1"># Test with small batch</span>
<span class="n">small_batch</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">small_batch</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</code></pre></div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/piotrlaczkowski/keras-data-processor" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://pypi.org/project/keras-data-processor/" target="_blank" rel="noopener" title="pypi.org" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M439.8 200.5c-7.7-30.9-22.3-54.2-53.4-54.2h-40.1v47.4c0 36.8-31.2 67.8-66.8 67.8H172.7c-29.2 0-53.4 25-53.4 54.3v101.8c0 29 25.2 46 53.4 54.3 33.8 9.9 66.3 11.7 106.8 0 26.9-7.8 53.4-23.5 53.4-54.3v-40.7H226.2v-13.6h160.2c31.1 0 42.6-21.7 53.4-54.2 11.2-33.5 10.7-65.7 0-108.6M286.2 444.7a20.4 20.4 0 1 1 0-40.7 20.4 20.4 0 1 1 0 40.7M167.8 248.1h106.8c29.7 0 53.4-24.5 53.4-54.3V91.9c0-29-24.4-50.7-53.4-55.6-35.8-5.9-74.7-5.6-106.8.1-45.2 8-53.4 24.7-53.4 55.6v40.7h106.9v13.6h-147c-31.1 0-58.3 18.7-66.8 54.2-9.8 40.7-10.2 66.1 0 108.6 7.6 31.6 25.7 54.2 56.8 54.2H101v-48.8c0-35.3 30.5-66.4 66.8-66.4m-6.6-183.4a20.4 20.4 0 1 1 0 40.8 20.4 20.4 0 1 1 0-40.8"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../assets/javascripts/bundle.50899def.min.js"></script>
      
        <script src="../assets/js/fix-image-paths.js"></script>
      
    
  </body>
</html>