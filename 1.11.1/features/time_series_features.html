
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://example.com/kdp/1.11.1/features/time_series_features.html">
      
      
        <link rel="prev" href="date-features.html">
      
      
        <link rel="next" href="cross-features.html">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.16">
    
    
      
        <title>📊 Time Series Features - KDP - Keras Data Preprocessor</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.7e37652d.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      
  
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
  
  <style>:root{--md-admonition-icon--note:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M1%207.775V2.75C1%201.784%201.784%201%202.75%201h5.025c.464%200%20.91.184%201.238.513l6.25%206.25a1.75%201.75%200%200%201%200%202.474l-5.026%205.026a1.75%201.75%200%200%201-2.474%200l-6.25-6.25A1.75%201.75%200%200%201%201%207.775m1.5%200c0%20.066.026.13.073.177l6.25%206.25a.25.25%200%200%200%20.354%200l5.025-5.025a.25.25%200%200%200%200-.354l-6.25-6.25a.25.25%200%200%200-.177-.073H2.75a.25.25%200%200%200-.25.25ZM6%205a1%201%200%201%201%200%202%201%201%200%200%201%200-2%22/%3E%3C/svg%3E');--md-admonition-icon--abstract:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M2.5%201.75v11.5c0%20.138.112.25.25.25h3.17a.75.75%200%200%201%200%201.5H2.75A1.75%201.75%200%200%201%201%2013.25V1.75C1%20.784%201.784%200%202.75%200h8.5C12.216%200%2013%20.784%2013%201.75v7.736a.75.75%200%200%201-1.5%200V1.75a.25.25%200%200%200-.25-.25h-8.5a.25.25%200%200%200-.25.25m13.274%209.537zl-4.557%204.45a.75.75%200%200%201-1.055-.008l-1.943-1.95a.75.75%200%200%201%201.062-1.058l1.419%201.425%204.026-3.932a.75.75%200%201%201%201.048%201.074M4.75%204h4.5a.75.75%200%200%201%200%201.5h-4.5a.75.75%200%200%201%200-1.5M4%207.75A.75.75%200%200%201%204.75%207h2a.75.75%200%200%201%200%201.5h-2A.75.75%200%200%201%204%207.75%22/%3E%3C/svg%3E');--md-admonition-icon--info:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M0%208a8%208%200%201%201%2016%200A8%208%200%200%201%200%208m8-6.5a6.5%206.5%200%201%200%200%2013%206.5%206.5%200%200%200%200-13M6.5%207.75A.75.75%200%200%201%207.25%207h1a.75.75%200%200%201%20.75.75v2.75h.25a.75.75%200%200%201%200%201.5h-2a.75.75%200%200%201%200-1.5h.25v-2h-.25a.75.75%200%200%201-.75-.75M8%206a1%201%200%201%201%200-2%201%201%200%200%201%200%202%22/%3E%3C/svg%3E');--md-admonition-icon--tip:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M3.499.75a.75.75%200%200%201%201.5%200v.996C5.9%202.903%206.793%203.65%207.662%204.376l.24.202c-.036-.694.055-1.422.426-2.163C9.1.873%2010.794-.045%2012.622.26%2014.408.558%2016%201.94%2016%204.25c0%201.278-.954%202.575-2.44%202.734l.146.508.065.22c.203.701.412%201.455.476%202.226.142%201.707-.4%203.03-1.487%203.898C11.714%2014.671%2010.27%2015%208.75%2015h-6a.75.75%200%200%201%200-1.5h1.376a4.5%204.5%200%200%201-.563-1.191%203.84%203.84%200%200%201-.05-2.063%204.65%204.65%200%200%201-2.025-.293.75.75%200%200%201%20.525-1.406c1.357.507%202.376-.006%202.698-.318l.009-.01a.747.747%200%200%201%201.06%200%20.75.75%200%200%201-.012%201.074c-.912.92-.992%201.835-.768%202.586.221.74.745%201.337%201.196%201.621H8.75c1.343%200%202.398-.296%203.074-.836.635-.507%201.036-1.31.928-2.602-.05-.603-.216-1.224-.422-1.93l-.064-.221c-.12-.407-.246-.84-.353-1.29a2.4%202.4%200%200%201-.507-.441%203.1%203.1%200%200%201-.633-1.248.75.75%200%200%201%201.455-.364c.046.185.144.436.31.627.146.168.353.305.712.305.738%200%201.25-.615%201.25-1.25%200-1.47-.95-2.315-2.123-2.51-1.172-.196-2.227.387-2.706%201.345-.46.92-.27%201.774.019%203.062l.042.19.01.05c.348.443.666.949.94%201.553a.75.75%200%201%201-1.365.62c-.553-1.217-1.32-1.94-2.3-2.768L6.7%205.527c-.814-.68-1.75-1.462-2.692-2.619a3.7%203.7%200%200%200-1.023.88c-.406.495-.663%201.036-.722%201.508.116.122.306.21.591.239.388.038.797-.06%201.032-.19a.75.75%200%200%201%20.728%201.31c-.515.287-1.23.439-1.906.373-.682-.067-1.473-.38-1.879-1.193L.75%205.677V5.5c0-.984.48-1.94%201.077-2.664.46-.559%201.05-1.055%201.673-1.353z%22/%3E%3C/svg%3E');--md-admonition-icon--success:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M13.78%204.22a.75.75%200%200%201%200%201.06l-7.25%207.25a.75.75%200%200%201-1.06%200L2.22%209.28a.75.75%200%200%201%20.018-1.042.75.75%200%200%201%201.042-.018L6%2010.94l6.72-6.72a.75.75%200%200%201%201.06%200%22/%3E%3C/svg%3E');--md-admonition-icon--question:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M0%208a8%208%200%201%201%2016%200A8%208%200%200%201%200%208m8-6.5a6.5%206.5%200%201%200%200%2013%206.5%206.5%200%200%200%200-13M6.92%206.085h.001a.749.749%200%201%201-1.342-.67c.169-.339.436-.701.849-.977C6.845%204.16%207.369%204%208%204a2.76%202.76%200%200%201%201.637.525c.503.377.863.965.863%201.725%200%20.448-.115.83-.329%201.15-.205.307-.47.513-.692.662-.109.072-.22.138-.313.195l-.006.004a6%206%200%200%200-.26.16%201%201%200%200%200-.276.245.75.75%200%200%201-1.248-.832c.184-.264.42-.489.692-.661q.154-.1.313-.195l.007-.004c.1-.061.182-.11.258-.161a1%201%200%200%200%20.277-.245C8.96%206.514%209%206.427%209%206.25a.61.61%200%200%200-.262-.525A1.27%201.27%200%200%200%208%205.5c-.369%200-.595.09-.74.187a1%201%200%200%200-.34.398M9%2011a1%201%200%201%201-2%200%201%201%200%200%201%202%200%22/%3E%3C/svg%3E');--md-admonition-icon--warning:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M6.457%201.047c.659-1.234%202.427-1.234%203.086%200l6.082%2011.378A1.75%201.75%200%200%201%2014.082%2015H1.918a1.75%201.75%200%200%201-1.543-2.575Zm1.763.707a.25.25%200%200%200-.44%200L1.698%2013.132a.25.25%200%200%200%20.22.368h12.164a.25.25%200%200%200%20.22-.368Zm.53%203.996v2.5a.75.75%200%200%201-1.5%200v-2.5a.75.75%200%200%201%201.5%200M9%2011a1%201%200%201%201-2%200%201%201%200%200%201%202%200%22/%3E%3C/svg%3E');--md-admonition-icon--failure:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M2.344%202.343za8%208%200%200%201%2011.314%2011.314A8.002%208.002%200%200%201%20.234%2010.089a8%208%200%200%201%202.11-7.746m1.06%2010.253a6.5%206.5%200%201%200%209.108-9.275%206.5%206.5%200%200%200-9.108%209.275M6.03%204.97%208%206.94l1.97-1.97a.749.749%200%200%201%201.275.326.75.75%200%200%201-.215.734L9.06%208l1.97%201.97a.749.749%200%200%201-.326%201.275.75.75%200%200%201-.734-.215L8%209.06l-1.97%201.97a.749.749%200%200%201-1.275-.326.75.75%200%200%201%20.215-.734L6.94%208%204.97%206.03a.75.75%200%200%201%20.018-1.042.75.75%200%200%201%201.042-.018%22/%3E%3C/svg%3E');--md-admonition-icon--danger:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M9.504.43a1.516%201.516%200%200%201%202.437%201.713L10.415%205.5h2.123c1.57%200%202.346%201.909%201.22%203.004l-7.34%207.142a1.25%201.25%200%200%201-.871.354h-.302a1.25%201.25%200%200%201-1.157-1.723L5.633%2010.5H3.462c-1.57%200-2.346-1.909-1.22-3.004zm1.047%201.074L3.286%208.571A.25.25%200%200%200%203.462%209H6.75a.75.75%200%200%201%20.694%201.034l-1.713%204.188%206.982-6.793A.25.25%200%200%200%2012.538%207H9.25a.75.75%200%200%201-.683-1.06l2.008-4.418.003-.006-.004-.009-.006-.006-.008-.001q-.005%200-.009.004%22/%3E%3C/svg%3E');--md-admonition-icon--bug:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M4.72.22a.75.75%200%200%201%201.06%200l1%20.999a3.5%203.5%200%200%201%202.441%200l.999-1a.748.748%200%200%201%201.265.332.75.75%200%200%201-.205.729l-.775.776c.616.63.995%201.493.995%202.444v.327q0%20.15-.025.292c.408.14.764.392%201.029.722l1.968-.787a.75.75%200%200%201%20.556%201.392L13%207.258V9h2.25a.75.75%200%200%201%200%201.5H13v.5q-.002.615-.141%201.186l2.17.868a.75.75%200%200%201-.557%201.392l-2.184-.873A5%205%200%200%201%208%2016a5%205%200%200%201-4.288-2.427l-2.183.873a.75.75%200%200%201-.558-1.392l2.17-.868A5%205%200%200%201%203%2011v-.5H.75a.75.75%200%200%201%200-1.5H3V7.258L.971%206.446a.75.75%200%200%201%20.558-1.392l1.967.787c.265-.33.62-.583%201.03-.722a1.7%201.7%200%200%201-.026-.292V4.5c0-.951.38-1.814.995-2.444L4.72%201.28a.75.75%200%200%201%200-1.06m.53%206.28a.75.75%200%200%200-.75.75V11a3.5%203.5%200%201%200%207%200V7.25a.75.75%200%200%200-.75-.75ZM6.173%205h3.654A.17.17%200%200%200%2010%204.827V4.5a2%202%200%201%200-4%200v.327c0%20.096.077.173.173.173%22/%3E%3C/svg%3E');--md-admonition-icon--example:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M5%205.782V2.5h-.25a.75.75%200%200%201%200-1.5h6.5a.75.75%200%200%201%200%201.5H11v3.282l3.666%205.76C15.619%2013.04%2014.543%2015%2012.767%2015H3.233c-1.776%200-2.852-1.96-1.899-3.458Zm-2.4%206.565a.75.75%200%200%200%20.633%201.153h9.534a.75.75%200%200%200%20.633-1.153L12.225%2010.5h-8.45ZM9.5%202.5h-3V6c0%20.143-.04.283-.117.403L4.73%209h6.54L9.617%206.403A.75.75%200%200%201%209.5%206Z%22/%3E%3C/svg%3E');--md-admonition-icon--quote:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M1.75%202.5h10.5a.75.75%200%200%201%200%201.5H1.75a.75.75%200%200%201%200-1.5m4%205h8.5a.75.75%200%200%201%200%201.5h-8.5a.75.75%200%200%201%200-1.5m0%205h8.5a.75.75%200%200%201%200%201.5h-8.5a.75.75%200%200%201%200-1.5M2.5%207.75v6a.75.75%200%200%201-1.5%200v-6a.75.75%200%200%201%201.5%200%22/%3E%3C/svg%3E');}</style>



    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent="black">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#time-series-features" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../index.html" title="KDP - Keras Data Preprocessor" class="md-header__button md-logo" aria-label="KDP - Keras Data Preprocessor" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 11a1 1 0 0 1 1 1 1 1 0 0 1-1 1 1 1 0 0 1-1-1 1 1 0 0 1 1-1M4.22 4.22C5.65 2.79 8.75 3.43 12 5.56c3.25-2.13 6.35-2.77 7.78-1.34s.79 4.53-1.34 7.78c2.13 3.25 2.77 6.35 1.34 7.78s-4.53.79-7.78-1.34c-3.25 2.13-6.35 2.77-7.78 1.34S3.43 15.25 5.56 12C3.43 8.75 2.79 5.65 4.22 4.22m11.32 4.24c.61.62 1.17 1.25 1.69 1.88 1.38-2.13 1.88-3.96 1.13-4.7-.74-.75-2.57-.25-4.7 1.13.63.52 1.26 1.08 1.88 1.69m-7.08 7.08c-.61-.62-1.17-1.25-1.69-1.88-1.38 2.13-1.88 3.96-1.13 4.7.74.75 2.57.25 4.7-1.13-.63-.52-1.26-1.08-1.88-1.69m-2.82-9.9c-.75.74-.25 2.57 1.13 4.7.52-.63 1.08-1.26 1.69-1.88.62-.61 1.25-1.17 1.88-1.69-2.13-1.38-3.96-1.88-4.7-1.13m4.24 8.48c.7.7 1.42 1.34 2.12 1.91.7-.57 1.42-1.21 2.12-1.91s1.34-1.42 1.91-2.12c-.57-.7-1.21-1.42-1.91-2.12S12.7 8.54 12 7.97c-.7.57-1.42 1.21-2.12 1.91S8.54 11.3 7.97 12c.57.7 1.21 1.42 1.91 2.12m8.48 4.24c.75-.74.25-2.57-1.13-4.7-.52.63-1.08 1.26-1.69 1.88-.62.61-1.25 1.17-1.88 1.69 2.13 1.38 3.96 1.88 4.7 1.13"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            KDP - Keras Data Preprocessor
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              📊 Time Series Features
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent="black"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="teal" data-md-color-accent="teal"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/piotrlaczkowski/keras-data-processor" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    Keras Data Preprocessor
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../index.html" title="KDP - Keras Data Preprocessor" class="md-nav__button md-logo" aria-label="KDP - Keras Data Preprocessor" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 11a1 1 0 0 1 1 1 1 1 0 0 1-1 1 1 1 0 0 1-1-1 1 1 0 0 1 1-1M4.22 4.22C5.65 2.79 8.75 3.43 12 5.56c3.25-2.13 6.35-2.77 7.78-1.34s.79 4.53-1.34 7.78c2.13 3.25 2.77 6.35 1.34 7.78s-4.53.79-7.78-1.34c-3.25 2.13-6.35 2.77-7.78 1.34S3.43 15.25 5.56 12C3.43 8.75 2.79 5.65 4.22 4.22m11.32 4.24c.61.62 1.17 1.25 1.69 1.88 1.38-2.13 1.88-3.96 1.13-4.7-.74-.75-2.57-.25-4.7 1.13.63.52 1.26 1.08 1.88 1.69m-7.08 7.08c-.61-.62-1.17-1.25-1.69-1.88-1.38 2.13-1.88 3.96-1.13 4.7.74.75 2.57.25 4.7-1.13-.63-.52-1.26-1.08-1.88-1.69m-2.82-9.9c-.75.74-.25 2.57 1.13 4.7.52-.63 1.08-1.26 1.69-1.88.62-.61 1.25-1.17 1.88-1.69-2.13-1.38-3.96-1.88-4.7-1.13m4.24 8.48c.7.7 1.42 1.34 2.12 1.91.7-.57 1.42-1.21 2.12-1.91s1.34-1.42 1.91-2.12c-.57-.7-1.21-1.42-1.91-2.12S12.7 8.54 12 7.97c-.7.57-1.42 1.21-2.12 1.91S8.54 11.3 7.97 12c.57.7 1.21 1.42 1.91 2.12m8.48 4.24c.75-.74.25-2.57-1.13-4.7-.52.63-1.08 1.26-1.69 1.88-.62.61-1.25 1.17-1.88 1.69 2.13 1.38 3.96 1.88 4.7 1.13"/></svg>

    </a>
    KDP - Keras Data Preprocessor
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/piotrlaczkowski/keras-data-processor" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    Keras Data Preprocessor
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    🏠 Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    🚀 Getting Started
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            🚀 Getting Started
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../getting-started/installation.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    📦 Installation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../getting-started/quick-start.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    🎯 Quick Start
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../getting-started/motivation.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    🌍 Why KDP?
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../getting-started/architecture.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    🧩 Architecture Overview
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    📚 Feature Types
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            📚 Feature Types
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="overview.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    🛠️ Features Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="numerical-features.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    🔢 Numerical Features
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="categorical-features.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    🏷️ Categorical Features
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="text-features.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    📝 Text Features
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="date-features.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    📅 Date Features
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    📊 Time Series Features
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="time_series_features.html" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    📊 Time Series Features
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    <span class="md-ellipsis">
      📋 Overview
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#types-of-time-series-transformations" class="md-nav__link">
    <span class="md-ellipsis">
      🚀 Types of Time Series Transformations
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#basic-usage" class="md-nav__link">
    <span class="md-ellipsis">
      📝 Basic Usage
    </span>
  </a>
  
    <nav class="md-nav" aria-label="📝 Basic Usage">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#option-1-using-feature-type-directly" class="md-nav__link">
    <span class="md-ellipsis">
      Option 1: Using Feature Type Directly
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#option-2-using-timeseriesfeature-class-recommended" class="md-nav__link">
    <span class="md-ellipsis">
      Option 2: Using TimeSeriesFeature Class (Recommended)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#advanced-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      🧠 Advanced Configuration
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#key-configuration-parameters" class="md-nav__link">
    <span class="md-ellipsis">
      ⚙️ Key Configuration Parameters
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#powerful-features" class="md-nav__link">
    <span class="md-ellipsis">
      💡 Powerful Features
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#real-world-examples" class="md-nav__link">
    <span class="md-ellipsis">
      🔧 Real-World Examples
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pro-tips" class="md-nav__link">
    <span class="md-ellipsis">
      💎 Pro Tips
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#model-architecture-diagrams" class="md-nav__link">
    <span class="md-ellipsis">
      📊 Model Architecture Diagrams
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#related-topics" class="md-nav__link">
    <span class="md-ellipsis">
      🔗 Related Topics
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#inference-with-time-series-features" class="md-nav__link">
    <span class="md-ellipsis">
      🔍 Inference with Time Series Features
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="cross-features.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ➕ Cross Features
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="passthrough-features.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    🔄 Passthrough Features
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    🧠 Advanced Features
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            🧠 Advanced Features
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../advanced/distribution-aware-encoding.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    📊 Distribution-Aware Encoding
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../advanced/numerical-embeddings.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    🔢 Advanced Numerical Embeddings
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../advanced/tabular-attention.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    👁️ Tabular Attention
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../advanced/transformer-blocks.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    🤖 Transformer Blocks
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../advanced/feature-moe.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    🧩 Feature-wise Mixture of Experts
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../advanced/custom-preprocessing.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    🛠️ Custom Preprocessing Pipelines
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    ⚡ Optimization
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            ⚡ Optimization
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../optimization/feature-selection.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    🎯 Feature Selection
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../optimization/tabular-optimization.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    📈 Tabular Optimization
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../optimization/auto-configuration.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ⚙️ Auto-Configuration
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    📖 Examples
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            📖 Examples
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/basic-examples.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    🧪 Basic Examples
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/complex-examples.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    🔥 Complex Examples
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/categorical-hashing-example.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    🧮 Categorical Hashing
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    🔌 Integration
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            🔌 Integration
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../integrations/overview.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    🔄 Integration Overview
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    🤝 Contributing
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            🤝 Contributing
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../contributing/overview.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    🍻 Contributing Guide
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../contributing/development/auto-documentation.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    📝 Auto-Documentation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../contributing/development/images-organization.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    🖼️ Images Organization
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" >
        
          
          <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    📑 API Reference
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            📑 API Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/layers-factory.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    🏭 Layers Factory
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated/api_index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    📚 API Index
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    <span class="md-ellipsis">
      📋 Overview
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#types-of-time-series-transformations" class="md-nav__link">
    <span class="md-ellipsis">
      🚀 Types of Time Series Transformations
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#basic-usage" class="md-nav__link">
    <span class="md-ellipsis">
      📝 Basic Usage
    </span>
  </a>
  
    <nav class="md-nav" aria-label="📝 Basic Usage">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#option-1-using-feature-type-directly" class="md-nav__link">
    <span class="md-ellipsis">
      Option 1: Using Feature Type Directly
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#option-2-using-timeseriesfeature-class-recommended" class="md-nav__link">
    <span class="md-ellipsis">
      Option 2: Using TimeSeriesFeature Class (Recommended)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#advanced-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      🧠 Advanced Configuration
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#key-configuration-parameters" class="md-nav__link">
    <span class="md-ellipsis">
      ⚙️ Key Configuration Parameters
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#powerful-features" class="md-nav__link">
    <span class="md-ellipsis">
      💡 Powerful Features
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#real-world-examples" class="md-nav__link">
    <span class="md-ellipsis">
      🔧 Real-World Examples
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pro-tips" class="md-nav__link">
    <span class="md-ellipsis">
      💎 Pro Tips
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#model-architecture-diagrams" class="md-nav__link">
    <span class="md-ellipsis">
      📊 Model Architecture Diagrams
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#related-topics" class="md-nav__link">
    <span class="md-ellipsis">
      🔗 Related Topics
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#inference-with-time-series-features" class="md-nav__link">
    <span class="md-ellipsis">
      🔍 Inference with Time Series Features
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="time-series-features">⏱️ Time Series Features</h1>
<div class="feature-header">
  <div class="feature-title">
    <h2>Time Series Features in KDP</h2>
    <p>Transform temporal data with powerful lag features, moving averages, differencing, rolling statistics, wavelet transforms, statistical features, and calendar features.</p>
  </div>
</div>

<h2 id="overview">📋 Overview</h2>
<div class="overview-card">
  <p>Time series features enable processing of chronological data by creating transformations that capture temporal patterns and relationships. KDP provides specialized layers for common time series operations that maintain data ordering while enabling advanced machine learning on sequential data.</p>
</div>

<h2 id="types-of-time-series-transformations">🚀 Types of Time Series Transformations</h2>
<div class="table-container">
  <table class="features-table">
    <thead>
      <tr>
        <th>Transformation</th>
        <th>Purpose</th>
        <th>Example</th>
        <th>When to Use</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><code>Lag Features</code></td>
        <td>Create features from past values</td>
        <td>Yesterday's sales, last week's sales</td>
        <td>When past values help predict future ones</td>
      </tr>
      <tr>
        <td><code>Rolling Statistics</code></td>
        <td>Compute statistics over windows</td>
        <td>7-day average, 30-day standard deviation</td>
        <td>When trends or volatility matter</td>
      </tr>
      <tr>
        <td><code>Differencing</code></td>
        <td>Calculate changes between values</td>
        <td>Day-over-day change in price</td>
        <td>When changes are more important than absolute values</td>
      </tr>
      <tr>
        <td><code>Moving Averages</code></td>
        <td>Smooth data over time</td>
        <td>7-day, 14-day, 28-day moving averages</td>
        <td>When you need to reduce noise and focus on trends</td>
      </tr>
      <tr>
        <td><code>Wavelet Transforms</code></td>
        <td>Multi-resolution analysis of time series</td>
        <td>Extracting coefficients at different scales</td>
        <td>When you need to analyze signals at multiple scales or frequencies</td>
      </tr>
      <tr>
        <td><code>Statistical Features</code></td>
        <td>Extract comprehensive statistical features</td>
        <td>Mean, variance, kurtosis, entropy, peaks</td>
        <td>When you need a rich set of features summarizing time series properties</td>
      </tr>
      <tr>
        <td><code>Calendar Features</code></td>
        <td>Extract date and time components</td>
        <td>Day of week, month, is_weekend, seasonality</td>
        <td>When seasonal patterns related to calendar time are relevant</td>
      </tr>
    </tbody>
  </table>
</div>

<h2 id="basic-usage">📝 Basic Usage</h2>
<p>There are two ways to define time series features in KDP:</p>
<h3 id="option-1-using-feature-type-directly">Option 1: Using Feature Type Directly</h3>
<div class="code-container">

<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">kdp</span><span class="w"> </span><span class="kn">import</span> <span class="n">PreprocessingModel</span><span class="p">,</span> <span class="n">FeatureType</span>

<span class="c1"># Define features with simple types</span>
<span class="n">features</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;sales&quot;</span><span class="p">:</span> <span class="n">FeatureType</span><span class="o">.</span><span class="n">TIME_SERIES</span><span class="p">,</span>  <span class="c1"># Basic time series feature</span>
    <span class="s2">&quot;date&quot;</span><span class="p">:</span> <span class="n">FeatureType</span><span class="o">.</span><span class="n">DATE</span><span class="p">,</span>          <span class="c1"># Date feature for sorting</span>
    <span class="s2">&quot;store_id&quot;</span><span class="p">:</span> <span class="n">FeatureType</span><span class="o">.</span><span class="n">STRING_CATEGORICAL</span>  <span class="c1"># Grouping variable</span>
<span class="p">}</span>

<span class="c1"># Create preprocessor</span>
<span class="n">preprocessor</span> <span class="o">=</span> <span class="n">PreprocessingModel</span><span class="p">(</span>
    <span class="n">path_data</span><span class="o">=</span><span class="s2">&quot;sales_data.csv&quot;</span><span class="p">,</span>
    <span class="n">features_specs</span><span class="o">=</span><span class="n">features</span>
<span class="p">)</span>
</code></pre></div>

</div>

<h3 id="option-2-using-timeseriesfeature-class-recommended">Option 2: Using TimeSeriesFeature Class (Recommended)</h3>
<div class="code-container">

<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">kdp</span><span class="w"> </span><span class="kn">import</span> <span class="n">PreprocessingModel</span><span class="p">,</span> <span class="n">TimeSeriesFeature</span>

<span class="c1"># Create a time series feature for daily sales data</span>
<span class="n">sales_ts</span> <span class="o">=</span> <span class="n">TimeSeriesFeature</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;sales&quot;</span><span class="p">,</span>
    <span class="c1"># Sort by date column to ensure chronological order</span>
    <span class="n">sort_by</span><span class="o">=</span><span class="s2">&quot;date&quot;</span><span class="p">,</span>
    <span class="c1"># Group by store to handle multiple time series</span>
    <span class="n">group_by</span><span class="o">=</span><span class="s2">&quot;store_id&quot;</span><span class="p">,</span>
    <span class="c1"># Create lag features for yesterday, last week, and two weeks ago</span>
    <span class="n">lag_config</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;lags&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">14</span><span class="p">],</span>
        <span class="s2">&quot;drop_na&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
        <span class="s2">&quot;fill_value&quot;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
        <span class="s2">&quot;keep_original&quot;</span><span class="p">:</span> <span class="kc">True</span>
    <span class="p">}</span>
<span class="p">)</span>

<span class="c1"># Define features using both approaches</span>
<span class="n">features</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;sales&quot;</span><span class="p">:</span> <span class="n">sales_ts</span><span class="p">,</span>
    <span class="s2">&quot;date&quot;</span><span class="p">:</span> <span class="s2">&quot;DATE&quot;</span><span class="p">,</span>          <span class="c1"># String shorthand for date feature</span>
    <span class="s2">&quot;store_id&quot;</span><span class="p">:</span> <span class="s2">&quot;STRING_CATEGORICAL&quot;</span>  <span class="c1"># String shorthand for categorical</span>
<span class="p">}</span>

<span class="c1"># Create preprocessor</span>
<span class="n">preprocessor</span> <span class="o">=</span> <span class="n">PreprocessingModel</span><span class="p">(</span>
    <span class="n">path_data</span><span class="o">=</span><span class="s2">&quot;sales_data.csv&quot;</span><span class="p">,</span>
    <span class="n">features_specs</span><span class="o">=</span><span class="n">features</span>
<span class="p">)</span>
</code></pre></div>

</div>

<h2 id="advanced-configuration">🧠 Advanced Configuration</h2>
<div class="advanced-section">
  <p>For comprehensive time series processing, configure multiple transformations in a single feature:</p>

  <div class="code-container">

<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">kdp</span><span class="w"> </span><span class="kn">import</span> <span class="n">TimeSeriesFeature</span><span class="p">,</span> <span class="n">PreprocessingModel</span>

<span class="c1"># Complete time series configuration with multiple transformations</span>
<span class="n">sales_feature</span> <span class="o">=</span> <span class="n">TimeSeriesFeature</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;sales&quot;</span><span class="p">,</span>
    <span class="c1"># Data ordering configuration</span>
    <span class="n">sort_by</span><span class="o">=</span><span class="s2">&quot;date&quot;</span><span class="p">,</span>                    <span class="c1"># Column to sort by</span>
    <span class="n">sort_ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>               <span class="c1"># Sort chronologically</span>
    <span class="n">group_by</span><span class="o">=</span><span class="s2">&quot;store_id&quot;</span><span class="p">,</span>               <span class="c1"># Group by store</span>

    <span class="c1"># Lag feature configuration</span>
    <span class="n">lag_config</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;lags&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">28</span><span class="p">],</span>        <span class="c1"># Previous day, week, 2 weeks, 4 weeks</span>
        <span class="s2">&quot;drop_na&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>               <span class="c1"># Remove rows with insufficient history</span>
        <span class="s2">&quot;fill_value&quot;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>             <span class="c1"># Value for missing lags if drop_na=False</span>
        <span class="s2">&quot;keep_original&quot;</span><span class="p">:</span> <span class="kc">True</span>          <span class="c1"># Include original values</span>
    <span class="p">},</span>

    <span class="c1"># Rolling statistics configuration</span>
    <span class="n">rolling_stats_config</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;window_size&quot;</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span>              <span class="c1"># 7-day rolling window</span>
        <span class="s2">&quot;statistics&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;mean&quot;</span><span class="p">,</span> <span class="s2">&quot;std&quot;</span><span class="p">,</span> <span class="s2">&quot;min&quot;</span><span class="p">,</span> <span class="s2">&quot;max&quot;</span><span class="p">],</span>  <span class="c1"># Statistics to compute</span>
        <span class="s2">&quot;window_stride&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>            <span class="c1"># Move window by 1 time step</span>
        <span class="s2">&quot;drop_na&quot;</span><span class="p">:</span> <span class="kc">True</span>                <span class="c1"># Remove rows with insufficient history</span>
    <span class="p">},</span>

    <span class="c1"># Differencing configuration</span>
    <span class="n">differencing_config</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;order&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>                    <span class="c1"># First-order differencing (t - (t-1))</span>
        <span class="s2">&quot;drop_na&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>               <span class="c1"># Remove rows with insufficient history</span>
        <span class="s2">&quot;fill_value&quot;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>             <span class="c1"># Value for missing diffs if drop_na=False</span>
        <span class="s2">&quot;keep_original&quot;</span><span class="p">:</span> <span class="kc">True</span>          <span class="c1"># Include original values</span>
    <span class="p">},</span>

    <span class="c1"># Moving average configuration</span>
    <span class="n">moving_average_config</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;periods&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">28</span><span class="p">],</span>        <span class="c1"># Weekly, bi-weekly, monthly averages</span>
        <span class="s2">&quot;drop_na&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>               <span class="c1"># Remove rows with insufficient history</span>
        <span class="s2">&quot;pad_value&quot;</span><span class="p">:</span> <span class="mf">0.0</span>               <span class="c1"># Value for padding if drop_na=False</span>
    <span class="p">},</span>

    <span class="c1"># Wavelet transform configuration</span>
    <span class="n">wavelet_transform_config</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;levels&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>                   <span class="c1"># Number of decomposition levels</span>
        <span class="s2">&quot;window_sizes&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">16</span><span class="p">],</span>    <span class="c1"># Optional custom window sizes for each level</span>
        <span class="s2">&quot;keep_levels&quot;</span><span class="p">:</span> <span class="s2">&quot;all&quot;</span><span class="p">,</span>          <span class="c1"># Which levels to keep (all or specific indices)</span>
        <span class="s2">&quot;flatten_output&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>        <span class="c1"># Whether to flatten multi-level output</span>
        <span class="s2">&quot;drop_na&quot;</span><span class="p">:</span> <span class="kc">True</span>                <span class="c1"># Handle missing values</span>
    <span class="p">},</span>

    <span class="c1"># TSFresh statistical features configuration</span>
    <span class="n">tsfresh_feature_config</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;features&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;mean&quot;</span><span class="p">,</span> <span class="s2">&quot;std&quot;</span><span class="p">,</span> <span class="s2">&quot;min&quot;</span><span class="p">,</span> <span class="s2">&quot;max&quot;</span><span class="p">,</span> <span class="s2">&quot;median&quot;</span><span class="p">],</span>  <span class="c1"># Features to extract</span>
        <span class="s2">&quot;window_size&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>           <span class="c1"># Window size (None for entire series)</span>
        <span class="s2">&quot;stride&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>                   <span class="c1"># Stride for sliding window</span>
        <span class="s2">&quot;drop_na&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>               <span class="c1"># Handle missing values</span>
        <span class="s2">&quot;normalize&quot;</span><span class="p">:</span> <span class="kc">False</span>             <span class="c1"># Whether to normalize features</span>
    <span class="p">},</span>

    <span class="c1"># Calendar feature configuration for date input</span>
    <span class="n">calendar_feature_config</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;features&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;month&quot;</span><span class="p">,</span> <span class="s2">&quot;day&quot;</span><span class="p">,</span> <span class="s2">&quot;day_of_week&quot;</span><span class="p">,</span> <span class="s2">&quot;is_weekend&quot;</span><span class="p">],</span>  <span class="c1"># Features to extract</span>
        <span class="s2">&quot;cyclic_encoding&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>       <span class="c1"># Use cyclic encoding for cyclical features</span>
        <span class="s2">&quot;input_format&quot;</span><span class="p">:</span> <span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">,</span>    <span class="c1"># Input date format</span>
        <span class="s2">&quot;normalize&quot;</span><span class="p">:</span> <span class="kc">True</span>              <span class="c1"># Whether to normalize outputs</span>
    <span class="p">}</span>
<span class="p">)</span>

<span class="c1"># Create features dictionary</span>
<span class="n">features</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;sales&quot;</span><span class="p">:</span> <span class="n">sales_feature</span><span class="p">,</span>
    <span class="s2">&quot;date&quot;</span><span class="p">:</span> <span class="s2">&quot;DATE&quot;</span><span class="p">,</span>
    <span class="s2">&quot;store_id&quot;</span><span class="p">:</span> <span class="s2">&quot;STRING_CATEGORICAL&quot;</span>
<span class="p">}</span>

<span class="c1"># Create preprocessor with time series feature</span>
<span class="n">preprocessor</span> <span class="o">=</span> <span class="n">PreprocessingModel</span><span class="p">(</span>
    <span class="n">path_data</span><span class="o">=</span><span class="s2">&quot;sales_data.csv&quot;</span><span class="p">,</span>
    <span class="n">features_specs</span><span class="o">=</span><span class="n">features</span>
<span class="p">)</span>
</code></pre></div>

  </div>
</div>

<h2 id="key-configuration-parameters">⚙️ Key Configuration Parameters</h2>
<div class="table-container">
  <table class="config-table">
    <thead>
      <tr>
        <th>Parameter</th>
        <th>Description</th>
        <th>Default</th>
        <th>Notes</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><code>sort_by</code></td>
        <td>Column used for ordering data</td>
        <td>Required</td>
        <td>Typically a date or timestamp column</td>
      </tr>
      <tr>
        <td><code>sort_ascending</code></td>
        <td>Sort direction</td>
        <td>True</td>
        <td>True for oldest→newest, False for newest→oldest</td>
      </tr>
      <tr>
        <td><code>group_by</code></td>
        <td>Column for grouping multiple series</td>
        <td>None</td>
        <td>Optional, for handling multiple related series</td>
      </tr>
      <tr>
        <td><code>lags</code></td>
        <td>Time steps to look back</td>
        <td>None</td>
        <td>List of integers, e.g. [1, 7] for yesterday and last week</td>
      </tr>
      <tr>
        <td><code>window_size</code></td>
        <td>Size of rolling window</td>
        <td>7</td>
        <td>Number of time steps to include in window</td>
      </tr>
      <tr>
        <td><code>statistics</code></td>
        <td>Rolling statistics to compute</td>
        <td>["mean"]</td>
        <td>Options: "mean", "std", "min", "max", "sum"</td>
      </tr>
      <tr>
        <td><code>order</code></td>
        <td>Differencing order</td>
        <td>1</td>
        <td>1=first difference, 2=second difference, etc.</td>
      </tr>
      <tr>
        <td><code>periods</code></td>
        <td>Moving average periods</td>
        <td>None</td>
        <td>List of integers, e.g. [7, 30] for weekly and monthly</td>
      </tr>
      <tr>
        <td><code>levels</code></td>
        <td>Number of wavelet decomposition levels</td>
        <td>3</td>
        <td>Higher values capture more scales of patterns</td>
      </tr>
      <tr>
        <td><code>window_sizes</code></td>
        <td>Custom window sizes for wavelet transform</td>
        <td>None</td>
        <td>Optional list of sizes, e.g. [4, 8, 16]</td>
      </tr>
      <tr>
        <td><code>tsfresh_features</code></td>
        <td>Statistical features to extract</td>
        <td>["mean", "std", "min", "max", "median"]</td>
        <td>List of statistical features to compute</td>
      </tr>
      <tr>
        <td><code>calendar_features</code></td>
        <td>Calendar components to extract</td>
        <td>["month", "day", "day_of_week", "is_weekend"]</td>
        <td>Date-based features extracted from timestamp</td>
      </tr>
      <tr>
        <td><code>cyclic_encoding</code></td>
        <td>Use sine/cosine encoding for cyclical features</td>
        <td>True</td>
        <td>Better captures cyclical nature of time features</td>
      </tr>
      <tr>
        <td><code>drop_na</code></td>
        <td>Remove rows with insufficient history</td>
        <td>True</td>
        <td>Set to False to keep all rows with padding</td>
      </tr>
    </tbody>
  </table>
</div>

<h2 id="powerful-features">💡 Powerful Features</h2>
<div class="power-features">
  <div class="power-feature-card">
    <h3>🔄 Automatic Data Ordering</h3>
    <p>KDP automatically handles the correct ordering of time series data:</p>
    <div class="code-container">

<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">kdp</span><span class="w"> </span><span class="kn">import</span> <span class="n">TimeSeriesFeature</span><span class="p">,</span> <span class="n">PreprocessingModel</span>

<span class="c1"># Define a time series feature with automatic ordering</span>
<span class="n">sales_ts</span> <span class="o">=</span> <span class="n">TimeSeriesFeature</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;sales&quot;</span><span class="p">,</span>
    <span class="c1"># Specify which column contains timestamps/dates</span>
    <span class="n">sort_by</span><span class="o">=</span><span class="s2">&quot;timestamp&quot;</span><span class="p">,</span>
    <span class="c1"># Sort in ascending order (oldest first)</span>
    <span class="n">sort_ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="c1"># Group by store to create separate series per store</span>
    <span class="n">group_by</span><span class="o">=</span><span class="s2">&quot;store_id&quot;</span><span class="p">,</span>
    <span class="c1"># Simple lag configuration</span>
    <span class="n">lag_config</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;lags&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">]}</span>
<span class="p">)</span>

<span class="c1"># Create features dictionary</span>
<span class="n">features</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;sales&quot;</span><span class="p">:</span> <span class="n">sales_ts</span><span class="p">,</span>
    <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;DATE&quot;</span><span class="p">,</span>
    <span class="s2">&quot;store_id&quot;</span><span class="p">:</span> <span class="s2">&quot;STRING_CATEGORICAL&quot;</span>
<span class="p">}</span>

<span class="c1"># Even with shuffled data, KDP will correctly order the features</span>
<span class="n">preprocessor</span> <span class="o">=</span> <span class="n">PreprocessingModel</span><span class="p">(</span>
    <span class="n">path_data</span><span class="o">=</span><span class="s2">&quot;shuffled_sales_data.csv&quot;</span><span class="p">,</span>
    <span class="n">features_specs</span><span class="o">=</span><span class="n">features</span>
<span class="p">)</span>

<span class="c1"># The preprocessor handles ordering before applying transformations</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">preprocessor</span><span class="o">.</span><span class="n">build_preprocessor</span><span class="p">()</span>
</code></pre></div>

    </div>
  </div>

  <div class="power-feature-card">
    <h3>🌊 Wavelet Transform Analysis</h3>
    <p>Extract multi-resolution features from time series data:</p>
    <div class="code-container">

<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">kdp</span><span class="w"> </span><span class="kn">import</span> <span class="n">TimeSeriesFeature</span><span class="p">,</span> <span class="n">PreprocessingModel</span>

<span class="c1"># Define a feature with wavelet transform</span>
<span class="n">sensor_data</span> <span class="o">=</span> <span class="n">TimeSeriesFeature</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;sensor_readings&quot;</span><span class="p">,</span>
    <span class="n">sort_by</span><span class="o">=</span><span class="s2">&quot;timestamp&quot;</span><span class="p">,</span>
    <span class="c1"># Wavelet transform configuration</span>
    <span class="n">wavelet_transform_config</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;levels&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>                <span class="c1"># Number of decomposition levels</span>
        <span class="s2">&quot;window_sizes&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">16</span><span class="p">],</span> <span class="c1"># Increasing window sizes for multi-scale analysis</span>
        <span class="s2">&quot;keep_levels&quot;</span><span class="p">:</span> <span class="s2">&quot;all&quot;</span><span class="p">,</span>       <span class="c1"># Keep coefficients from all levels</span>
        <span class="s2">&quot;flatten_output&quot;</span><span class="p">:</span> <span class="kc">True</span>      <span class="c1"># Flatten coefficients into feature vector</span>
    <span class="p">}</span>
<span class="p">)</span>

<span class="c1"># Create features dictionary</span>
<span class="n">features</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;sensor_readings&quot;</span><span class="p">:</span> <span class="n">sensor_data</span><span class="p">,</span>
    <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;DATE&quot;</span>
<span class="p">}</span>

<span class="c1"># Create preprocessor for signal analysis</span>
<span class="n">preprocessor</span> <span class="o">=</span> <span class="n">PreprocessingModel</span><span class="p">(</span>
    <span class="n">path_data</span><span class="o">=</span><span class="s2">&quot;sensor_data.csv&quot;</span><span class="p">,</span>
    <span class="n">features_specs</span><span class="o">=</span><span class="n">features</span>
<span class="p">)</span>

<span class="c1"># The wavelet transform decomposes the signal into different frequency bands,</span>
<span class="c1"># helping to identify patterns at multiple scales</span>
</code></pre></div>

    </div>
  </div>

  <div class="power-feature-card">
    <h3>📊 Statistical Feature Extraction</h3>
    <p>Automatically extract rich statistical features from time series:</p>
    <div class="code-container">

<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">kdp</span><span class="w"> </span><span class="kn">import</span> <span class="n">TimeSeriesFeature</span><span class="p">,</span> <span class="n">PreprocessingModel</span>

<span class="c1"># Define a feature with statistical features extraction</span>
<span class="n">ecg_data</span> <span class="o">=</span> <span class="n">TimeSeriesFeature</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;ecg_signal&quot;</span><span class="p">,</span>
    <span class="n">sort_by</span><span class="o">=</span><span class="s2">&quot;timestamp&quot;</span><span class="p">,</span>
    <span class="c1"># Statistical feature extraction</span>
    <span class="n">tsfresh_feature_config</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;features&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="s2">&quot;mean&quot;</span><span class="p">,</span> <span class="s2">&quot;std&quot;</span><span class="p">,</span> <span class="s2">&quot;min&quot;</span><span class="p">,</span> <span class="s2">&quot;max&quot;</span><span class="p">,</span> <span class="s2">&quot;median&quot;</span><span class="p">,</span>
            <span class="s2">&quot;abs_energy&quot;</span><span class="p">,</span> <span class="s2">&quot;count_above_mean&quot;</span><span class="p">,</span> <span class="s2">&quot;count_below_mean&quot;</span><span class="p">,</span>
            <span class="s2">&quot;kurtosis&quot;</span><span class="p">,</span> <span class="s2">&quot;skewness&quot;</span>
        <span class="p">],</span>
        <span class="s2">&quot;window_size&quot;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span>  <span class="c1"># Extract features from windows of 100 points</span>
        <span class="s2">&quot;stride&quot;</span><span class="p">:</span> <span class="mi">50</span><span class="p">,</span>        <span class="c1"># Slide window by 50 points</span>
        <span class="s2">&quot;normalize&quot;</span><span class="p">:</span> <span class="kc">True</span>    <span class="c1"># Normalize extracted features</span>
    <span class="p">}</span>
<span class="p">)</span>

<span class="c1"># Create features dictionary</span>
<span class="n">features</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;ecg_signal&quot;</span><span class="p">:</span> <span class="n">ecg_data</span><span class="p">,</span>
    <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;DATE&quot;</span><span class="p">,</span>
    <span class="s2">&quot;patient_id&quot;</span><span class="p">:</span> <span class="s2">&quot;STRING_CATEGORICAL&quot;</span>
<span class="p">}</span>

<span class="c1"># Create preprocessor</span>
<span class="n">preprocessor</span> <span class="o">=</span> <span class="n">PreprocessingModel</span><span class="p">(</span>
    <span class="n">path_data</span><span class="o">=</span><span class="s2">&quot;ecg_data.csv&quot;</span><span class="p">,</span>
    <span class="n">features_specs</span><span class="o">=</span><span class="n">features</span>
<span class="p">)</span>

<span class="c1"># The statistical features capture important characteristics of the signal</span>
<span class="c1"># without requiring domain expertise to manually design features</span>
</code></pre></div>

    </div>
  </div>

  <div class="power-feature-card">
    <h3>📅 Calendar Feature Integration</h3>
    <p>Extract and encode calendar features directly from date inputs:</p>
    <div class="code-container">

<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">kdp</span><span class="w"> </span><span class="kn">import</span> <span class="n">TimeSeriesFeature</span><span class="p">,</span> <span class="n">PreprocessingModel</span>

<span class="c1"># Define a feature with calendar feature extraction</span>
<span class="n">traffic_data</span> <span class="o">=</span> <span class="n">TimeSeriesFeature</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;traffic_volume&quot;</span><span class="p">,</span>
    <span class="n">sort_by</span><span class="o">=</span><span class="s2">&quot;timestamp&quot;</span><span class="p">,</span>
    <span class="n">group_by</span><span class="o">=</span><span class="s2">&quot;location_id&quot;</span><span class="p">,</span>

    <span class="c1"># Lag features for short-term patterns</span>
    <span class="n">lag_config</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;lags&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="mi">24</span><span class="o">*</span><span class="mi">7</span><span class="p">]},</span>  <span class="c1"># Hours back</span>

    <span class="c1"># Calendar features for temporal patterns</span>
    <span class="n">calendar_feature_config</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;features&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="s2">&quot;month&quot;</span><span class="p">,</span> <span class="s2">&quot;day_of_week&quot;</span><span class="p">,</span> <span class="s2">&quot;hour&quot;</span><span class="p">,</span> <span class="s2">&quot;is_weekend&quot;</span><span class="p">,</span>
            <span class="s2">&quot;is_month_start&quot;</span><span class="p">,</span> <span class="s2">&quot;is_month_end&quot;</span>
        <span class="p">],</span>
        <span class="s2">&quot;cyclic_encoding&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>     <span class="c1"># Use sine/cosine encoding for cyclical features</span>
        <span class="s2">&quot;input_format&quot;</span><span class="p">:</span> <span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2"> %H:%M:%S&quot;</span>  <span class="c1"># Datetime format</span>
    <span class="p">}</span>
<span class="p">)</span>

<span class="c1"># Create features dictionary</span>
<span class="n">features</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;traffic_volume&quot;</span><span class="p">:</span> <span class="n">traffic_data</span><span class="p">,</span>
    <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;DATE&quot;</span><span class="p">,</span>
    <span class="s2">&quot;location_id&quot;</span><span class="p">:</span> <span class="s2">&quot;STRING_CATEGORICAL&quot;</span>
<span class="p">}</span>

<span class="c1"># Create preprocessor for traffic prediction</span>
<span class="n">preprocessor</span> <span class="o">=</span> <span class="n">PreprocessingModel</span><span class="p">(</span>
    <span class="n">path_data</span><span class="o">=</span><span class="s2">&quot;traffic_data.csv&quot;</span><span class="p">,</span>
    <span class="n">features_specs</span><span class="o">=</span><span class="n">features</span>
<span class="p">)</span>

<span class="c1"># Calendar features automatically capture important temporal patterns</span>
<span class="c1"># like rush hour traffic, weekend effects, and monthly patterns</span>
</code></pre></div>

    </div>
  </div>
</div>

<h2 id="real-world-examples">🔧 Real-World Examples</h2>
<div class="examples-container">
  <div class="example-card">
    <h3>📈 Retail Sales Forecasting</h3>
    <div class="code-container">

<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">kdp</span><span class="w"> </span><span class="kn">import</span> <span class="n">PreprocessingModel</span><span class="p">,</span> <span class="n">TimeSeriesFeature</span><span class="p">,</span> <span class="n">DateFeature</span><span class="p">,</span> <span class="n">CategoricalFeature</span>

<span class="c1"># Define features for sales forecasting</span>
<span class="n">features</span> <span class="o">=</span> <span class="p">{</span>
    <span class="c1"># Time series features for sales data</span>
    <span class="s2">&quot;sales&quot;</span><span class="p">:</span> <span class="n">TimeSeriesFeature</span><span class="p">(</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;sales&quot;</span><span class="p">,</span>
        <span class="n">sort_by</span><span class="o">=</span><span class="s2">&quot;date&quot;</span><span class="p">,</span>
        <span class="n">group_by</span><span class="o">=</span><span class="s2">&quot;store_id&quot;</span><span class="p">,</span>
        <span class="c1"># Recent sales and same period in previous years</span>
        <span class="n">lag_config</span><span class="o">=</span><span class="p">{</span>
            <span class="s2">&quot;lags&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">365</span><span class="p">,</span> <span class="mi">365</span><span class="o">+</span><span class="mi">7</span><span class="p">],</span>
            <span class="s2">&quot;keep_original&quot;</span><span class="p">:</span> <span class="kc">True</span>
        <span class="p">},</span>
        <span class="c1"># Weekly and monthly trends</span>
        <span class="n">rolling_stats_config</span><span class="o">=</span><span class="p">{</span>
            <span class="s2">&quot;window_size&quot;</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span>
            <span class="s2">&quot;statistics&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;mean&quot;</span><span class="p">,</span> <span class="s2">&quot;std&quot;</span><span class="p">,</span> <span class="s2">&quot;min&quot;</span><span class="p">,</span> <span class="s2">&quot;max&quot;</span><span class="p">]</span>
        <span class="p">},</span>
        <span class="c1"># Day-over-day changes</span>
        <span class="n">differencing_config</span><span class="o">=</span><span class="p">{</span>
            <span class="s2">&quot;order&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
            <span class="s2">&quot;keep_original&quot;</span><span class="p">:</span> <span class="kc">True</span>
        <span class="p">},</span>
        <span class="c1"># Weekly, monthly, quarterly smoothing</span>
        <span class="n">moving_average_config</span><span class="o">=</span><span class="p">{</span>
            <span class="s2">&quot;periods&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">90</span><span class="p">]</span>
        <span class="p">},</span>
        <span class="c1"># Calendar features for seasonal patterns</span>
        <span class="n">calendar_feature_config</span><span class="o">=</span><span class="p">{</span>
            <span class="s2">&quot;features&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;month&quot;</span><span class="p">,</span> <span class="s2">&quot;day_of_week&quot;</span><span class="p">,</span> <span class="s2">&quot;is_weekend&quot;</span><span class="p">,</span> <span class="s2">&quot;is_holiday&quot;</span><span class="p">],</span>
            <span class="s2">&quot;cyclic_encoding&quot;</span><span class="p">:</span> <span class="kc">True</span>
        <span class="p">}</span>
    <span class="p">),</span>

    <span class="c1"># Store features</span>
    <span class="s2">&quot;store_id&quot;</span><span class="p">:</span> <span class="n">CategoricalFeature</span><span class="p">(</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;store_id&quot;</span><span class="p">,</span>
        <span class="n">embedding_dim</span><span class="o">=</span><span class="mi">8</span>
    <span class="p">),</span>

    <span class="c1"># Product category</span>
    <span class="s2">&quot;product_category&quot;</span><span class="p">:</span> <span class="n">CategoricalFeature</span><span class="p">(</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;product_category&quot;</span><span class="p">,</span>
        <span class="n">embedding_dim</span><span class="o">=</span><span class="mi">8</span>
    <span class="p">)</span>
<span class="p">}</span>

<span class="c1"># Create preprocessor</span>
<span class="n">sales_forecaster</span> <span class="o">=</span> <span class="n">PreprocessingModel</span><span class="p">(</span>
    <span class="n">path_data</span><span class="o">=</span><span class="s2">&quot;sales_data.csv&quot;</span><span class="p">,</span>
    <span class="n">features_specs</span><span class="o">=</span><span class="n">features</span><span class="p">,</span>
    <span class="n">output_mode</span><span class="o">=</span><span class="s2">&quot;concat&quot;</span>
<span class="p">)</span>

<span class="c1"># Build preprocessor</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">sales_forecaster</span><span class="o">.</span><span class="n">build_preprocessor</span><span class="p">()</span>
</code></pre></div>

    </div>
  </div>

  <div class="example-card">
    <h3>📊 Stock Price Analysis with Advanced Features</h3>
    <div class="code-container">

<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">kdp</span><span class="w"> </span><span class="kn">import</span> <span class="n">PreprocessingModel</span><span class="p">,</span> <span class="n">TimeSeriesFeature</span><span class="p">,</span> <span class="n">NumericalFeature</span><span class="p">,</span> <span class="n">CategoricalFeature</span>

<span class="c1"># Define features for financial analysis</span>
<span class="n">features</span> <span class="o">=</span> <span class="p">{</span>
    <span class="c1"># Price as time series</span>
    <span class="s2">&quot;price&quot;</span><span class="p">:</span> <span class="n">TimeSeriesFeature</span><span class="p">(</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;price&quot;</span><span class="p">,</span>
        <span class="n">sort_by</span><span class="o">=</span><span class="s2">&quot;date&quot;</span><span class="p">,</span>
        <span class="n">group_by</span><span class="o">=</span><span class="s2">&quot;ticker&quot;</span><span class="p">,</span>
        <span class="c1"># Recent prices and historical patterns</span>
        <span class="n">lag_config</span><span class="o">=</span><span class="p">{</span>
            <span class="s2">&quot;lags&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">60</span><span class="p">],</span>  <span class="c1"># Days back</span>
            <span class="s2">&quot;keep_original&quot;</span><span class="p">:</span> <span class="kc">True</span>
        <span class="p">},</span>
        <span class="c1"># Trend analysis</span>
        <span class="n">rolling_stats_config</span><span class="o">=</span><span class="p">{</span>
            <span class="s2">&quot;window_size&quot;</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span>  <span class="c1"># Trading month</span>
            <span class="s2">&quot;statistics&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;mean&quot;</span><span class="p">,</span> <span class="s2">&quot;std&quot;</span><span class="p">,</span> <span class="s2">&quot;min&quot;</span><span class="p">,</span> <span class="s2">&quot;max&quot;</span><span class="p">]</span>
        <span class="p">},</span>
        <span class="c1"># Multi-scale price patterns with wavelet transform</span>
        <span class="n">wavelet_transform_config</span><span class="o">=</span><span class="p">{</span>
            <span class="s2">&quot;levels&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>  <span class="c1"># Capture short, medium, and long-term patterns</span>
            <span class="s2">&quot;flatten_output&quot;</span><span class="p">:</span> <span class="kc">True</span>
        <span class="p">},</span>
        <span class="c1"># Statistical features for price characteristics</span>
        <span class="n">tsfresh_feature_config</span><span class="o">=</span><span class="p">{</span>
            <span class="s2">&quot;features&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;mean&quot;</span><span class="p">,</span> <span class="s2">&quot;variance&quot;</span><span class="p">,</span> <span class="s2">&quot;skewness&quot;</span><span class="p">,</span> <span class="s2">&quot;kurtosis&quot;</span><span class="p">,</span>
                         <span class="s2">&quot;abs_energy&quot;</span><span class="p">,</span> <span class="s2">&quot;count_above_mean&quot;</span><span class="p">,</span> <span class="s2">&quot;longest_strike_above_mean&quot;</span><span class="p">]</span>
        <span class="p">}</span>
    <span class="p">),</span>

    <span class="c1"># Volume information</span>
    <span class="s2">&quot;volume&quot;</span><span class="p">:</span> <span class="n">TimeSeriesFeature</span><span class="p">(</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;volume&quot;</span><span class="p">,</span>
        <span class="n">sort_by</span><span class="o">=</span><span class="s2">&quot;date&quot;</span><span class="p">,</span>
        <span class="n">group_by</span><span class="o">=</span><span class="s2">&quot;ticker&quot;</span><span class="p">,</span>
        <span class="n">lag_config</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;lags&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">20</span><span class="p">]},</span>
        <span class="n">rolling_stats_config</span><span class="o">=</span><span class="p">{</span>
            <span class="s2">&quot;window_size&quot;</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span>
            <span class="s2">&quot;statistics&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;mean&quot;</span><span class="p">,</span> <span class="s2">&quot;std&quot;</span><span class="p">]</span>
        <span class="p">}</span>
    <span class="p">),</span>

    <span class="c1"># Market cap</span>
    <span class="s2">&quot;market_cap&quot;</span><span class="p">:</span> <span class="n">NumericalFeature</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;market_cap&quot;</span><span class="p">),</span>

    <span class="c1"># Sector/industry</span>
    <span class="s2">&quot;sector&quot;</span><span class="p">:</span> <span class="n">CategoricalFeature</span><span class="p">(</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;sector&quot;</span><span class="p">,</span>
        <span class="n">embedding_dim</span><span class="o">=</span><span class="mi">12</span>
    <span class="p">),</span>

    <span class="c1"># Date feature with calendar effects</span>
    <span class="s2">&quot;date&quot;</span><span class="p">:</span> <span class="n">TimeSeriesFeature</span><span class="p">(</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;date&quot;</span><span class="p">,</span>
        <span class="n">calendar_feature_config</span><span class="o">=</span><span class="p">{</span>
            <span class="s2">&quot;features&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;month&quot;</span><span class="p">,</span> <span class="s2">&quot;day_of_week&quot;</span><span class="p">,</span> <span class="s2">&quot;is_month_start&quot;</span><span class="p">,</span> <span class="s2">&quot;is_month_end&quot;</span><span class="p">,</span> <span class="s2">&quot;quarter&quot;</span><span class="p">],</span>
            <span class="s2">&quot;cyclic_encoding&quot;</span><span class="p">:</span> <span class="kc">True</span>
        <span class="p">}</span>
    <span class="p">)</span>
<span class="p">}</span>

<span class="c1"># Create preprocessor for stock price prediction</span>
<span class="n">stock_predictor</span> <span class="o">=</span> <span class="n">PreprocessingModel</span><span class="p">(</span>
    <span class="n">path_data</span><span class="o">=</span><span class="s2">&quot;stock_data.csv&quot;</span><span class="p">,</span>
    <span class="n">features_specs</span><span class="o">=</span><span class="n">features</span><span class="p">,</span>
    <span class="n">output_mode</span><span class="o">=</span><span class="s2">&quot;concat&quot;</span>
<span class="p">)</span>
</code></pre></div>

    </div>
  </div>

  <div class="example-card">
    <h3>⚕️ Patient Monitoring with Advanced Features</h3>
    <div class="code-container">

<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">kdp</span><span class="w"> </span><span class="kn">import</span> <span class="n">PreprocessingModel</span><span class="p">,</span> <span class="n">TimeSeriesFeature</span><span class="p">,</span> <span class="n">NumericalFeature</span><span class="p">,</span> <span class="n">CategoricalFeature</span>

<span class="c1"># Define features for patient monitoring</span>
<span class="n">features</span> <span class="o">=</span> <span class="p">{</span>
    <span class="c1"># Vital signs as time series</span>
    <span class="s2">&quot;heart_rate&quot;</span><span class="p">:</span> <span class="n">TimeSeriesFeature</span><span class="p">(</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;heart_rate&quot;</span><span class="p">,</span>
        <span class="n">sort_by</span><span class="o">=</span><span class="s2">&quot;timestamp&quot;</span><span class="p">,</span>
        <span class="n">group_by</span><span class="o">=</span><span class="s2">&quot;patient_id&quot;</span><span class="p">,</span>
        <span class="c1"># Recent measurements</span>
        <span class="n">lag_config</span><span class="o">=</span><span class="p">{</span>
            <span class="s2">&quot;lags&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">24</span><span class="p">],</span>  <span class="c1"># Hours back</span>
            <span class="s2">&quot;keep_original&quot;</span><span class="p">:</span> <span class="kc">True</span>
        <span class="p">},</span>
        <span class="c1"># Short and long-term trends</span>
        <span class="n">rolling_stats_config</span><span class="o">=</span><span class="p">{</span>
            <span class="s2">&quot;window_size&quot;</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span>  <span class="c1"># 6-hour window</span>
            <span class="s2">&quot;statistics&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;mean&quot;</span><span class="p">,</span> <span class="s2">&quot;std&quot;</span><span class="p">,</span> <span class="s2">&quot;min&quot;</span><span class="p">,</span> <span class="s2">&quot;max&quot;</span><span class="p">]</span>
        <span class="p">},</span>
        <span class="c1"># Extract rich statistical features automatically</span>
        <span class="n">tsfresh_feature_config</span><span class="o">=</span><span class="p">{</span>
            <span class="s2">&quot;features&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;mean&quot;</span><span class="p">,</span> <span class="s2">&quot;variance&quot;</span><span class="p">,</span> <span class="s2">&quot;abs_energy&quot;</span><span class="p">,</span> <span class="s2">&quot;count_above_mean&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;skewness&quot;</span><span class="p">,</span> <span class="s2">&quot;kurtosis&quot;</span><span class="p">,</span> <span class="s2">&quot;maximum&quot;</span><span class="p">,</span> <span class="s2">&quot;minimum&quot;</span><span class="p">],</span>
            <span class="s2">&quot;window_size&quot;</span><span class="p">:</span> <span class="mi">24</span>  <span class="c1"># 24-hour window for comprehensive analysis</span>
        <span class="p">},</span>
        <span class="c1"># Multi-scale analysis for pattern detection</span>
        <span class="n">wavelet_transform_config</span><span class="o">=</span><span class="p">{</span>
            <span class="s2">&quot;levels&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
            <span class="s2">&quot;flatten_output&quot;</span><span class="p">:</span> <span class="kc">True</span>
        <span class="p">}</span>
    <span class="p">),</span>

    <span class="c1"># Blood pressure</span>
    <span class="s2">&quot;blood_pressure&quot;</span><span class="p">:</span> <span class="n">TimeSeriesFeature</span><span class="p">(</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;blood_pressure&quot;</span><span class="p">,</span>
        <span class="n">sort_by</span><span class="o">=</span><span class="s2">&quot;timestamp&quot;</span><span class="p">,</span>
        <span class="n">group_by</span><span class="o">=</span><span class="s2">&quot;patient_id&quot;</span><span class="p">,</span>
        <span class="n">lag_config</span><span class="o">=</span><span class="p">{</span>
            <span class="s2">&quot;lags&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">24</span><span class="p">]</span>
        <span class="p">},</span>
        <span class="n">rolling_stats_config</span><span class="o">=</span><span class="p">{</span>
            <span class="s2">&quot;window_size&quot;</span><span class="p">:</span> <span class="mi">12</span><span class="p">,</span>  <span class="c1"># 12-hour window</span>
            <span class="s2">&quot;statistics&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;mean&quot;</span><span class="p">,</span> <span class="s2">&quot;std&quot;</span><span class="p">]</span>
        <span class="p">},</span>
        <span class="c1"># Extract statistical patterns</span>
        <span class="n">tsfresh_feature_config</span><span class="o">=</span><span class="p">{</span>
            <span class="s2">&quot;features&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;mean&quot;</span><span class="p">,</span> <span class="s2">&quot;variance&quot;</span><span class="p">,</span> <span class="s2">&quot;maximum&quot;</span><span class="p">,</span> <span class="s2">&quot;minimum&quot;</span><span class="p">]</span>
        <span class="p">}</span>
    <span class="p">),</span>

    <span class="c1"># Body temperature</span>
    <span class="s2">&quot;temperature&quot;</span><span class="p">:</span> <span class="n">TimeSeriesFeature</span><span class="p">(</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;temperature&quot;</span><span class="p">,</span>
        <span class="n">sort_by</span><span class="o">=</span><span class="s2">&quot;timestamp&quot;</span><span class="p">,</span>
        <span class="n">group_by</span><span class="o">=</span><span class="s2">&quot;patient_id&quot;</span><span class="p">,</span>
        <span class="n">lag_config</span><span class="o">=</span><span class="p">{</span>
            <span class="s2">&quot;lags&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">12</span><span class="p">]</span>
        <span class="p">},</span>
        <span class="n">rolling_stats_config</span><span class="o">=</span><span class="p">{</span>
            <span class="s2">&quot;window_size&quot;</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span>
            <span class="s2">&quot;statistics&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;mean&quot;</span><span class="p">,</span> <span class="s2">&quot;min&quot;</span><span class="p">,</span> <span class="s2">&quot;max&quot;</span><span class="p">]</span>
        <span class="p">}</span>
    <span class="p">),</span>

    <span class="c1"># Patient demographics</span>
    <span class="s2">&quot;age&quot;</span><span class="p">:</span> <span class="n">NumericalFeature</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;age&quot;</span><span class="p">),</span>
    <span class="s2">&quot;gender&quot;</span><span class="p">:</span> <span class="n">CategoricalFeature</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;gender&quot;</span><span class="p">),</span>
    <span class="s2">&quot;diagnosis&quot;</span><span class="p">:</span> <span class="n">CategoricalFeature</span><span class="p">(</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;diagnosis&quot;</span><span class="p">,</span>
        <span class="n">embedding_dim</span><span class="o">=</span><span class="mi">16</span>
    <span class="p">),</span>

    <span class="c1"># Time information with calendar features</span>
    <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="n">TimeSeriesFeature</span><span class="p">(</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;timestamp&quot;</span><span class="p">,</span>
        <span class="n">calendar_feature_config</span><span class="o">=</span><span class="p">{</span>
            <span class="s2">&quot;features&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;hour&quot;</span><span class="p">,</span> <span class="s2">&quot;day_of_week&quot;</span><span class="p">,</span> <span class="s2">&quot;is_weekend&quot;</span><span class="p">,</span> <span class="s2">&quot;month&quot;</span><span class="p">],</span>
            <span class="s2">&quot;cyclic_encoding&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
            <span class="s2">&quot;normalize&quot;</span><span class="p">:</span> <span class="kc">True</span>
        <span class="p">}</span>
    <span class="p">)</span>
<span class="p">}</span>

<span class="c1"># Create preprocessor for patient risk prediction</span>
<span class="n">patient_monitor</span> <span class="o">=</span> <span class="n">PreprocessingModel</span><span class="p">(</span>
    <span class="n">path_data</span><span class="o">=</span><span class="s2">&quot;patient_data.csv&quot;</span><span class="p">,</span>
    <span class="n">features_specs</span><span class="o">=</span><span class="n">features</span><span class="p">,</span>
    <span class="n">output_mode</span><span class="o">=</span><span class="s2">&quot;concat&quot;</span>
<span class="p">)</span>

<span class="c1"># The combination of lag features, statistical features, and wavelet transform</span>
<span class="c1"># enables detection of complex patterns in vital signs, while calendar features</span>
<span class="c1"># capture temporal variations in patient condition by time of day and day of week</span>
</code></pre></div>

    </div>
  </div>
</div>

<h2 id="pro-tips">💎 Pro Tips</h2>
<div class="pro-tips-grid">
  <div class="pro-tip-card">
    <h3>🔍 Choose Meaningful Lag Features</h3>
    <p>When selecting lag indices, consider domain knowledge about your data:</p>
    <ul>
      <li>For daily data: include 1 (yesterday), 7 (last week), and 30 (last month)</li>
      <li>For hourly data: include 1, 24 (same hour yesterday), 168 (same hour last week)</li>
      <li>For seasonal patterns: include 365 (same day last year) for annual data</li>
      <li>For quarterly financials: include 1, 4 (same quarter last year)</li>
    </ul>
    <p>This captures daily, weekly, and seasonal patterns that might exist in your data.</p>
  </div>

  <div class="pro-tip-card">
    <h3>📊 Combine Multiple Transformations</h3>
    <p>Different time series transformations capture different aspects of your data:</p>
    <ul>
      <li><strong>Lag features:</strong> Capture direct dependencies on past values</li>
      <li><strong>Rolling statistics:</strong> Capture trends and volatility</li>
      <li><strong>Differencing:</strong> Captures changes and removes trend</li>
      <li><strong>Moving averages:</strong> Smooths noise and highlights trends</li>
    </ul>
    <p>Using these together creates a rich feature set that captures various temporal patterns.</p>
  </div>

  <div class="pro-tip-card">
    <h3>⚠️ Handle the Cold Start Problem</h3>
    <p>New time series may not have enough history for lag features:</p>
    <div class="code-container">

<div class="highlight"><pre><span></span><code><span class="c1"># Gracefully handle new entities with insufficient history</span>
<span class="n">sales_ts</span> <span class="o">=</span> <span class="n">TimeSeriesFeature</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;sales&quot;</span><span class="p">,</span>
    <span class="n">sort_by</span><span class="o">=</span><span class="s2">&quot;date&quot;</span><span class="p">,</span>
    <span class="n">group_by</span><span class="o">=</span><span class="s2">&quot;store_id&quot;</span><span class="p">,</span>
    <span class="n">lag_config</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;lags&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span>
        <span class="s2">&quot;drop_na&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>     <span class="c1"># Keep rows with missing lags</span>
        <span class="s2">&quot;fill_value&quot;</span><span class="p">:</span> <span class="mf">0.0</span>     <span class="c1"># Use 0 for missing values</span>
    <span class="p">}</span>
<span class="p">)</span>

<span class="c1"># Alternative approach for handling new stores</span>
<span class="n">features</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;sales&quot;</span><span class="p">:</span> <span class="n">sales_ts</span><span class="p">,</span>
    <span class="s2">&quot;store_age&quot;</span><span class="p">:</span> <span class="n">NumericalFeature</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;store_age&quot;</span><span class="p">),</span>  <span class="c1"># Track how long the store has existed</span>
    <span class="s2">&quot;date&quot;</span><span class="p">:</span> <span class="s2">&quot;DATE&quot;</span><span class="p">,</span>
    <span class="s2">&quot;store_id&quot;</span><span class="p">:</span> <span class="s2">&quot;STRING_CATEGORICAL&quot;</span>
<span class="p">}</span>
</code></pre></div>

   </div>
  </div>

  <div class="pro-tip-card">
    <h3>🔬 Advanced Time Series Feature Engineering</h3>
    <p>The new advanced time series features provide powerful tools for extracting patterns:</p>
    <ul>
      <li><strong>Wavelet Transforms:</strong> Ideal for capturing multi-scale patterns and transient events. Use higher levels (3-5) for more decomposition detail.</li>
      <li><strong>Statistical Features:</strong> The TSFresh-inspired features automatically extract a comprehensive set of statistical descriptors that would be time-consuming to calculate manually.</li>
      <li><strong>Calendar Features:</strong> Combine with cyclic encoding to properly represent the circular nature of time (e.g., December is close to January).</li>
    </ul>
    <p>For optimal results, combine these advanced features with traditional ones:</p>
    <div class="code-container">

<div class="highlight"><pre><span></span><code><span class="c1"># Comprehensive time series feature engineering</span>
<span class="n">sensor_feature</span> <span class="o">=</span> <span class="n">TimeSeriesFeature</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;sensor_data&quot;</span><span class="p">,</span>
    <span class="n">sort_by</span><span class="o">=</span><span class="s2">&quot;timestamp&quot;</span><span class="p">,</span>

    <span class="c1"># Traditional features</span>
    <span class="n">lag_config</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;lags&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]},</span>
    <span class="n">rolling_stats_config</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;window_size&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="s2">&quot;statistics&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;mean&quot;</span><span class="p">,</span> <span class="s2">&quot;std&quot;</span><span class="p">]},</span>

    <span class="c1"># Advanced features</span>
    <span class="n">wavelet_transform_config</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;levels&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">},</span>
    <span class="n">tsfresh_feature_config</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;features&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;mean&quot;</span><span class="p">,</span> <span class="s2">&quot;variance&quot;</span><span class="p">,</span> <span class="s2">&quot;abs_energy&quot;</span><span class="p">]},</span>
    <span class="n">calendar_feature_config</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;features&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;hour&quot;</span><span class="p">,</span> <span class="s2">&quot;day_of_week&quot;</span><span class="p">]}</span>
<span class="p">)</span>

<span class="c1"># This combination captures temporal dependencies (lags),</span>
<span class="c1"># local statistics (rolling stats), multi-scale patterns (wavelets),</span>
<span class="c1"># global statistics (tsfresh), and temporal context (calendar)</span>
</code></pre></div>

   </div>
  </div>
</div>

<h2 id="model-architecture-diagrams">📊 Model Architecture Diagrams</h2>
<div class="model-diagrams">
  <div class="diagram-card">
    <h3>Basic Time Series Feature</h3>
    <div class="diagram-image">
      <img src="imgs/models/basic_time_series.png" alt="Basic Time Series Feature Architecture">
    </div>
    <p>A basic time series feature with date sorting and group handling, showing how KDP integrates time series data with date features and categorical grouping variables.</p>
  </div>

  <div class="diagram-card">
    <h3>Time Series with Lag Features</h3>
    <div class="diagram-image">
      <img src="imgs/models/time_series_with_lags.png" alt="Time Series with Lag Features Architecture">
    </div>
    <p>This diagram shows how lag features are integrated into the preprocessing model, allowing the model to access historical values from previous time steps.</p>
  </div>

  <div class="diagram-card">
    <h3>Time Series with Moving Averages</h3>
    <div class="diagram-image">
      <img src="imgs/models/time_series_moving_average.png" alt="Time Series with Moving Averages Architecture">
    </div>
    <p>Moving averages smooth out noise in the time series data, highlighting underlying trends. This diagram shows how KDP implements moving average calculations in the preprocessing pipeline.</p>
  </div>

  <div class="diagram-card">
    <h3>Time Series with Differencing</h3>
    <div class="diagram-image">
      <img src="imgs/models/time_series_differencing.png" alt="Time Series with Differencing Architecture">
    </div>
    <p>Differencing captures changes between consecutive time steps, helping to make time series stationary. This diagram shows the implementation of differencing in the KDP architecture.</p>
  </div>

  <div class="diagram-card">
    <h3>Time Series with All Features</h3>
    <div class="diagram-image">
      <img src="imgs/models/time_series_all_features.png" alt="Time Series with All Features Combined Architecture">
    </div>
    <p>A comprehensive time series preprocessing pipeline that combines lag features, rolling statistics, differencing, and moving averages to capture all aspects of the temporal patterns in the data.</p>
  </div>
</div>

<h2 id="related-topics">🔗 Related Topics</h2>
<div class="related-topics">
  <a href="categorical-features.md" class="topic-link">
    <span class="topic-icon">🏷️</span>
    <span class="topic-text">Categorical Features</span>
  </a>
  <a href="numerical-features.md" class="topic-link">
    <span class="topic-icon">🔢</span>
    <span class="topic-text">Numerical Features</span>
  </a>
  <a href="../advanced/custom-layers.md" class="topic-link">
    <span class="topic-icon">🧩</span>
    <span class="topic-text">Custom Preprocessing Layers</span>
  </a>
  <a href="../examples/time-series-forecasting.md" class="topic-link">
    <span class="topic-icon">📈</span>
    <span class="topic-text">Time Series Forecasting Examples</span>
  </a>
</div>

<hr />
<div class="nav-container">
  <a href="text-features.md" class="nav-button prev">
    <span class="nav-icon">←</span>
    <span class="nav-text">Text Features</span>
  </a>
  <a href="image-features.md" class="nav-button next">
    <span class="nav-text">Image Features</span>
    <span class="nav-icon">→</span>
  </a>
</div>

<h2 id="inference-with-time-series-features">🔍 Inference with Time Series Features</h2>
<div class="inference-section">
  <p>Time series preprocessing requires special consideration during inference. Unlike static features, time series transformations depend on historical data and context.</p>

  <h3>Minimal Requirements for Inference</h3>

  <div class="table-container">
    <table class="inference-table">
      <thead>
        <tr>
          <th>Transformation</th>
          <th>Minimum Data Required</th>
          <th>Notes</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td><code>Lag Features</code></td>
          <td>max(lags) previous time points</td>
          <td>If largest lag is 14, you need 14 previous data points</td>
        </tr>
        <tr>
          <td><code>Rolling Statistics</code></td>
          <td>window_size previous points</td>
          <td>For a 7-day window, you need 7 previous points</td>
        </tr>
        <tr>
          <td><code>Differencing</code></td>
          <td>order previous points</td>
          <td>First-order differencing requires 1 previous point</td>
        </tr>
        <tr>
          <td><code>Moving Averages</code></td>
          <td>max(periods) previous points</td>
          <td>For periods [7,14,28], you need 28 previous points</td>
        </tr>
        <tr>
          <td><code>Wavelet Transform</code></td>
          <td>2^levels previous points</td>
          <td>For 3 levels, you need at least 8 previous points</td>
        </tr>
      </tbody>
    </table>
  </div>

  <h3>Example: Single-Point Inference</h3>

  <p>For single-point or incremental inference with time series features:</p>

  <div class="code-container">

<div class="highlight"><pre><span></span><code><span class="c1"># INCORRECT - Will fail with time series features</span>
<span class="n">single_point</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;date&quot;</span><span class="p">:</span> <span class="s2">&quot;2023-06-01&quot;</span><span class="p">,</span> <span class="s2">&quot;store_id&quot;</span><span class="p">:</span> <span class="s2">&quot;Store_1&quot;</span><span class="p">,</span> <span class="s2">&quot;sales&quot;</span><span class="p">:</span> <span class="mf">150.0</span><span class="p">}</span>
<span class="n">prediction</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">single_point</span><span class="p">)</span>  <span class="c1"># ❌ Missing historical context</span>

<span class="c1"># CORRECT - Include historical context</span>
<span class="n">inference_data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;date&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;2023-05-25&quot;</span><span class="p">,</span> <span class="s2">&quot;2023-05-26&quot;</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="s2">&quot;2023-06-01&quot;</span><span class="p">],</span>  <span class="c1"># Include history</span>
    <span class="s2">&quot;store_id&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Store_1&quot;</span><span class="p">,</span> <span class="s2">&quot;Store_1&quot;</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="s2">&quot;Store_1&quot;</span><span class="p">],</span>       <span class="c1"># Same group</span>
    <span class="s2">&quot;sales&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">125.0</span><span class="p">,</span> <span class="mf">130.0</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="mf">150.0</span><span class="p">]</span>                       <span class="c1"># Historical values</span>
<span class="p">}</span>
<span class="n">prediction</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">inference_data</span><span class="p">)</span>  <span class="c1"># ✅ Last row will have prediction</span>
</code></pre></div>

  </div>

  <h3>Strategies for Ongoing Predictions</h3>

  <p>For forecasting multiple steps into the future:</p>

  <div class="code-container">

<div class="highlight"><pre><span></span><code><span class="c1"># Multi-step forecasting with KDP</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>

<span class="c1"># 1. Start with historical data</span>
<span class="n">history_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s2">&quot;date&quot;</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s2">&quot;2023-01-01&quot;</span><span class="p">,</span> <span class="s2">&quot;2023-05-31&quot;</span><span class="p">),</span>
    <span class="s2">&quot;store_id&quot;</span><span class="p">:</span> <span class="s2">&quot;Store_1&quot;</span><span class="p">,</span>
    <span class="s2">&quot;sales&quot;</span><span class="p">:</span> <span class="n">historical_values</span>  <span class="c1"># Your historical data</span>
<span class="p">})</span>

<span class="c1"># 2. Create future dates to predict</span>
<span class="n">future_dates</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s2">&quot;2023-06-01&quot;</span><span class="p">,</span> <span class="s2">&quot;2023-06-30&quot;</span><span class="p">)</span>
<span class="n">forecast_horizon</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">future_dates</span><span class="p">)</span>

<span class="c1"># 3. Initialize with history</span>
<span class="n">working_df</span> <span class="o">=</span> <span class="n">history_df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="c1"># 4. Iterative forecasting</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">forecast_horizon</span><span class="p">):</span>
    <span class="c1"># Prepare next date to forecast</span>
    <span class="n">next_date</span> <span class="o">=</span> <span class="n">future_dates</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="n">next_row</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
        <span class="s2">&quot;date&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">next_date</span><span class="p">],</span>
        <span class="s2">&quot;store_id&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Store_1&quot;</span><span class="p">],</span>
        <span class="s2">&quot;sales&quot;</span><span class="p">:</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span>  <span class="c1"># Unknown value we want to predict</span>
    <span class="p">})</span>

    <span class="c1"># Add to working data</span>
    <span class="n">temp_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">working_df</span><span class="p">,</span> <span class="n">next_row</span><span class="p">])</span>

    <span class="c1"># Make prediction (returns all rows, take last one)</span>
    <span class="n">prediction</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">temp_df</span><span class="p">)</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="s2">&quot;sales&quot;</span><span class="p">]</span>

    <span class="c1"># Update the working dataframe with the prediction</span>
    <span class="n">next_row</span><span class="p">[</span><span class="s2">&quot;sales&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">prediction</span>
    <span class="n">working_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">working_df</span><span class="p">,</span> <span class="n">next_row</span><span class="p">])</span>

<span class="c1"># Final forecast is in the last forecast_horizon rows</span>
<span class="n">forecast</span> <span class="o">=</span> <span class="n">working_df</span><span class="o">.</span><span class="n">tail</span><span class="p">(</span><span class="n">forecast_horizon</span><span class="p">)</span>
</code></pre></div>

  </div>

  <h3>Key Considerations for Inference</h3>

  <ul>
    <li><strong>Group Integrity</strong>: Maintain the same groups used during training</li>
    <li><strong>Chronological Order</strong>: Ensure data is properly sorted by time</li>
    <li><strong>Sufficient History</strong>: Provide enough history for each group</li>
    <li><strong>Empty Fields</strong>: For auto-regressive forecasting, leave future values as None or NaN</li>
    <li><strong>Overlapping Windows</strong>: For multi-step forecasts, consider whether predictions should feed back as inputs</li>
  </ul>
</div>

<style>
/* Base styling */
body {
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
  line-height: 1.6;
  color: #333;
  margin: 0;
  padding: 0;
}

/* Feature header */
.feature-header {
  background: linear-gradient(135deg, #43a047 0%, #1de9b6 100%);
  border-radius: 10px;
  padding: 30px;
  margin: 30px 0;
  box-shadow: 0 4px 6px rgba(0,0,0,0.1);
  color: white;
}

.feature-title h2 {
  margin-top: 0;
  font-size: 28px;
}

.feature-title p {
  font-size: 18px;
  margin-bottom: 0;
  opacity: 0.9;
}

/* Overview card */
.overview-card {
  background-color: #fff;
  border-radius: 10px;
  padding: 20px 25px;
  margin: 20px 0;
  box-shadow: 0 2px 5px rgba(0,0,0,0.05);
  border-left: 4px solid #43a047;
}

.overview-card p {
  margin: 0;
  font-size: 16px;
}

/* Tables */
.table-container {
  margin: 30px 0;
  border-radius: 10px;
  overflow: hidden;
  box-shadow: 0 4px 8px rgba(0,0,0,0.05);
}

.features-table, .config-table {
  width: 100%;
  border-collapse: collapse;
}

.features-table th, .config-table th {
  background-color: #f0fff0;
  padding: 15px;
  text-align: left;
  font-weight: 600;
  border-bottom: 2px solid #43a047;
}

.features-table td, .config-table td {
  padding: 12px 15px;
  border-bottom: 1px solid #eaecef;
}

.features-table tr:nth-child(even), .config-table tr:nth-child(even) {
  background-color: #f8f9fa;
}

.features-table tr:hover, .config-table tr:hover {
  background-color: #f0fff0;
}

/* Code containers */
.code-container {
  background-color: #f8f9fa;
  border-radius: 8px;
  overflow: hidden;
  box-shadow: 0 2px 5px rgba(0,0,0,0.1);
  margin: 20px 0;
}

.code-container pre {
  margin: 0;
  padding: 20px;
}

/* Advanced section */
.advanced-section {
  background-color: #f8f9fa;
  border-radius: 10px;
  padding: 20px;
  margin: 30px 0;
  border-left: 4px solid #43a047;
}

.advanced-section p {
  margin-top: 0;
}

/* Power features */
.power-features {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(400px, 1fr));
  gap: 20px;
  margin: 30px 0;
}

.power-feature-card {
  background-color: #fff;
  border-radius: 10px;
  padding: 20px;
  box-shadow: 0 4px 8px rgba(0,0,0,0.05);
  transition: transform 0.3s ease, box-shadow 0.3s ease;
}

.power-feature-card:hover {
  transform: translateY(-5px);
  box-shadow: 0 8px 16px rgba(0,0,0,0.1);
}

.power-feature-card h3 {
  margin-top: 0;
  color: #43a047;
}

/* Examples */
.examples-container {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(400px, 1fr));
  gap: 20px;
  margin: 30px 0;
}

.example-card {
  background-color: #fff;
  border-radius: 10px;
  padding: 20px;
  box-shadow: 0 4px 8px rgba(0,0,0,0.05);
  transition: transform 0.3s ease, box-shadow 0.3s ease;
}

.example-card:hover {
  transform: translateY(-5px);
  box-shadow: 0 8px 16px rgba(0,0,0,0.1);
}

.example-card h3 {
  margin-top: 0;
  color: #43a047;
}

/* Pro tips */
.pro-tips-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(400px, 1fr));
  gap: 20px;
  margin: 30px 0;
}

.pro-tip-card {
  background-color: #fff;
  border-radius: 10px;
  padding: 20px;
  box-shadow: 0 4px 8px rgba(0,0,0,0.05);
  transition: transform 0.3s ease, box-shadow 0.3s ease;
}

.pro-tip-card:hover {
  transform: translateY(-5px);
  box-shadow: 0 8px 16px rgba(0,0,0,0.1);
}

.pro-tip-card h3 {
  margin-top: 0;
  color: #43a047;
}

.pro-tip-card p {
  margin-bottom: 10px;
}

/* Architecture diagram */
.architecture-diagram {
  background-color: white;
  border-radius: 10px;
  padding: 20px;
  margin: 30px 0;
  box-shadow: 0 4px 8px rgba(0,0,0,0.05);
  text-align: center;
}

.diagram-caption {
  margin-top: 20px;
  text-align: center;
  font-style: italic;
}

/* Related topics */
.related-topics {
  display: flex;
  flex-wrap: wrap;
  gap: 15px;
  margin: 30px 0;
}

.topic-link {
  display: flex;
  align-items: center;
  padding: 10px 15px;
  background-color: #f0fff0;
  border-radius: 8px;
  text-decoration: none;
  color: #333;
  box-shadow: 0 2px 5px rgba(0,0,0,0.05);
  transition: background-color 0.3s ease, transform 0.3s ease;
}

.topic-link:hover {
  background-color: #e0f2e0;
  transform: translateY(-2px);
}

.topic-icon {
  font-size: 1.2em;
  margin-right: 10px;
}

/* Navigation */
.nav-container {
  display: flex;
  justify-content: space-between;
  margin: 40px 0;
}

.nav-button {
  display: flex;
  align-items: center;
  padding: 10px 15px;
  background-color: #f8f9fa;
  border-radius: 8px;
  text-decoration: none;
  color: #333;
  box-shadow: 0 2px 5px rgba(0,0,0,0.1);
  transition: background-color 0.3s ease, transform 0.3s ease;
}

.nav-button:hover {
  background-color: #f0fff0;
  transform: translateY(-2px);
}

.nav-button.prev {
  padding-left: 10px;
}

.nav-button.next {
  padding-right: 10px;
}

.nav-icon {
  font-size: 1.2em;
  margin: 0 8px;
}

/* Responsive adjustments */
@media (max-width: 768px) {
  .power-features,
  .examples-container,
  .pro-tips-grid {
    grid-template-columns: 1fr;
  }

  .related-topics {
    flex-direction: column;
  }
}
</style>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/piotrlaczkowski/keras-data-processor" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://pypi.org/project/keras-data-processor/" target="_blank" rel="noopener" title="pypi.org" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M439.8 200.5c-7.7-30.9-22.3-54.2-53.4-54.2h-40.1v47.4c0 36.8-31.2 67.8-66.8 67.8H172.7c-29.2 0-53.4 25-53.4 54.3v101.8c0 29 25.2 46 53.4 54.3 33.8 9.9 66.3 11.7 106.8 0 26.9-7.8 53.4-23.5 53.4-54.3v-40.7H226.2v-13.6h160.2c31.1 0 42.6-21.7 53.4-54.2 11.2-33.5 10.7-65.7 0-108.6M286.2 444.7a20.4 20.4 0 1 1 0-40.7 20.4 20.4 0 1 1 0 40.7M167.8 248.1h106.8c29.7 0 53.4-24.5 53.4-54.3V91.9c0-29-24.4-50.7-53.4-55.6-35.8-5.9-74.7-5.6-106.8.1-45.2 8-53.4 24.7-53.4 55.6v40.7h106.9v13.6h-147c-31.1 0-58.3 18.7-66.8 54.2-9.8 40.7-10.2 66.1 0 108.6 7.6 31.6 25.7 54.2 56.8 54.2H101v-48.8c0-35.3 30.5-66.4 66.8-66.4m-6.6-183.4a20.4 20.4 0 1 1 0 40.8 20.4 20.4 0 1 1 0-40.8"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../assets/javascripts/bundle.50899def.min.js"></script>
      
        <script src="../assets/js/fix-image-paths.js"></script>
      
    
  </body>
</html>